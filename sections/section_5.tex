\documentclass[../engineering_mathematics_lecture_note.tex]{subfiles}
\begin{document}
\begin{example}
    미분방정식\marginpar{\small 2018.11.12}
    \begin{equation*}
        y' = y
    \end{equation*}
    이 초기값
    \begin{equation*}
        y(0) = 1
    \end{equation*}
    을 만족할 때, $y$를 다음과 같은 멱급수(power series)로 나타내자:
    \begin{equation*}
        y = \sum_{n = 0}^\infty a_n x^n
    \end{equation*}
    이를 미분한 $y'$은
    \begin{equation*}
        y' = \sum_{n = 0}^\infty n a_n x^{n - 1} = \sum_{n = 0}^\infty (n + 1) a_{n + 1} x^n
    \end{equation*}
    가 된다.
    그런데 $y = y'$이므로
    \begin{equation*}
        \forall n \in \mathbb N \cup \{0\} \qquad (n + 1) a_{n + 1} = a_n
    \end{equation*}
    을 만족한다.
    따라서
    \begin{equation*}
        a_1 = a_0, \quad a_2 = \frac{1}{2!} a_0, \quad a_3 = \frac{1}{3!} a_0, \quad \dots, \quad a_n = \frac{1}{n!} a_0
    \end{equation*}
    또한 초기값 $y(0) = 1$에 따라 $a_0 = 1$이므로 $k = 1, \dots, n$에 대해
    \begin{equation*}
        a_k = \frac{1}{k!} a_0 = \frac{1}{k!}
    \end{equation*}
    이다.
    이때
    \begin{equation*}
        \lim_{n \to \infty} \frac{a_{n + 1}}{a_n} = \lim_{n \to \infty} \frac{n}{n+1} = 0
    \end{equation*}
    이므로 멱급수 $y = \sum_{n = 0}^\infty a_n x^n$의 수렴반경은 $\infty$이다.
    그러므로
    \begin{equation*}
        \forall x \in \mathbb R \qquad y = \sum_{n = 0}^\infty \frac{1}{n!} x^n = \sum^{\infty}_{n = 0} e^x
    \end{equation*}
    를 만족하며, 해의 유일성에 따라 $y = e^x$가 이 초기값 문제의 해이다.
\end{example}

\begin{example}
    미분방정식
    \begin{equation*}
        y'' + y = 0
    \end{equation*}
    이 초기값
    \begin{equation*}
        y(0) = a_0, \qquad y'(0) = a_1
    \end{equation*}
    을 만족할 때, 마찬가지로 $y$를 멱급수 $y = \sum_{n = 0}^\infty a_n x^n$로 나타내면,
    \begin{equation*}
        y'' = \sum^{\infty}_{n = 0} n (n - 1) a_n x^{n - 2} = \sum^{\infty}_{n = 0} (n + 1) (n + 2) a_{n + 2} x^n
    \end{equation*}
    이 된다.
    $y'' + y = 0$이므로
    \begin{equation*}
        \forall n \in \mathbb N \cup \{0\} \qquad  (n + 1) (n + 2) a_{n + 2} + a_n = 0
    \end{equation*}
    이다.
    먼저 $n$이 짝수일 경우에 $a_n$들을 계산해보자.
    \begin{align*}
        a_2 &= \frac{-1}{2 \cdot 1} a_0\\
        a_3 &= \frac{-1}{4 \cdot 3} a_2 = \frac{(-1)^2}{4 \cdot 3 \cdot 2 \cdot 1} a_0\\
            &\vdotswithin{=}\\
        a_{2n} &= \frac{(-1)^n}{(2n)!} a_0
    \end{align*}
    또한 $n$이 홀수일 경우에는
    \begin{align*}
        a_3 &= \frac{-1}{3 \cdot 2} a_1\\
        a_3 &= \frac{-1}{5 \cdot 4} a_3 = \frac{(-1)^2}{5 \cdot 4 \cdot 3 \cdot 2} a_1\\
            &\vdotswithin{=}\\
        a_{2n + 1} &= \frac{(-1)^n}{(2n + 1)!} a_1
    \end{align*}
    이다.
    모든 짝수차 항들을 더하면
    \begin{equation*}
        \sum^{\infty}_{n = 0} a_{2n} x^{2n} = a_0 \sum^{\infty}_{n = 0} \frac{(-1)^n}{(2n)!} x^{2n} = a_0 \cos x
    \end{equation*}
    가 되고, 위의 수렴 반경은 $\infty$이다.
    마찬가지로 홀수차 항들을 더하면
    \begin{equation*}
        \sum^{\infty}_{n = 0} a_{2n + 1} x^{2n + 1} = a_1 \sum^{\infty}_{n = 0} \frac{(-1)^n}{(2n + 1)!} x^{2n + 1} = a_1 \sin x
    \end{equation*}
    이며 수렴 반경은 $\infty$이다.
    따라서 미분방정식의 해 $y$는 해의 유일성에 의해
    \begin{equation*}
        y = a_0 \cos x + a_1 \sin x
    \end{equation*}
    이다.
\end{example}

그러나 멱급수를 대입하여 풀기 힘든 미분방정식도 존재한다.
\begin{example}
    오일러-코시 방정식
    \begin{equation*}
        x^2 y' + \frac 16 x y' + \frac 16 y = 0
    \end{equation*}
    에 멱급수 $y = \sum_{n = 0}^\infty a_n x^n$를 대입하면
    \begin{equation*}
        \sum^{\infty}_{n = 0} \left( n^2 - \frac 56 n + \frac 16 \right) a_n x^n = 0
    \end{equation*}
    이 된다.
    그런데 방정식 $n^2 - \dfrac 56 n + \dfrac 16 = 0$을 만족하는 정수해 $n$은 존재하지 않아 풀 수 없다.
\end{example}

\begin{definition}
    2계 제차 선형 상미분방정식
    \begin{equation*}
        p(x) y'' + q(x) y' + r(x) = 0
    \end{equation*}
    에 대해서 $p, q, r$이 $x = 0$에서 해석적(analytic)이라고 하자.
    $p(0) \neq 0$인 경우에는 $x = 0$에서 정칙점(regular point)이라고 한다.
    반면 $p(0) = 0$인 경우에는 $x = 0$에서 특이점(singular point)이라고 한다.
\end{definition}

일반적으로 특이점에서는 멱급수를 통해 미분방정식을 풀기가 힘들지만, 베셀 방정식과 같이 급수해를 구할 수 있는 특수한 경우에 대해서 다룰 것이다.

\begin{example}
    다음과 같은 2계 선형 상미분방정식을 에어리 미분방정식(Airy differential equation)이라고 한다\footnote{천문학자 조지 비델 에어리(George Biddell Airy, 1801\,\char`~1892)가 1838년에 도입한 이 방정식은 광학 등에서 사용된다.}:
    \begin{equation} \label{eq:airy}
        y'' - xy = 0
    \end{equation}
    $y$를 멱급수 $\sum_{n = 0}^\infty a_n x^n$로 나타내면
    \begin{equation*}
        xy = \sum^{\infty}_{n = 0} a_n x^{n + 1}
    \end{equation*}
    이고
    \begin{equation*}
        y'' = \sum^{\infty}_{n = 0} n(n - 1) a_n x^{n - 2} = \sum^{\infty}_{n = 0} (n + 3)(n + 2)a_{n + 3} x^{n + 1} + 2a_2
    \end{equation*}
    이므로 식~\ref{eq:airy}에 대입하여
    \begin{align*}
        y'' - xy &= \left(\sum^{\infty}_{n = 0} (n + 3) (n + 2) a_{n + 3} x^{n + 1} + 2a_2\right) - \sum^{\infty}_{n = 0} a_n x^{n + 1}\\
                 &= \sum^{\infty}_{n = 0} \bigl( (n + 3) (n + 2) a_{n + 3} - a_n \bigr) x^{n + 1} + 2a_2 = 0
    \end{align*}
    와 같이 쓸 수 있다.
    따라서
    \begin{equation*}
        a_2 = 0, \qquad a_{n + 3} = \frac{1}{(n + 3) (n + 2)} a_n
    \end{equation*}
    이다.
    즉
    \begin{equation*}
        a_{3m + 2} = 0 \quad \text{where } m \in \mathbb N \cup \{0\}
    \end{equation*}
    이며, 초기 조건을
    \begin{equation*}
        y(0) = a_0, \qquad y'(0) = a_1
    \end{equation*}
    로 놓으면 $m \in \mathbb N$일 때 $a_{3m + 1}$와 $a_{3m}$도 계산할 수 있다.
    이때 $\dfrac{a_{3m + 1}}{a_{3m}}$이 일정하지 않기 때문에 둘은 일차독립이다.
\end{example}

\begin{example}
    다음은 르장드르 미분방정식(Legendre differential equation)이다\footnote{아드리앵마리 르장드르(Adrien-Marie Legendre, 1752\,\char`~1833)의 이름을 딴 이 방정식은 구면 좌표계의 퍼텐셜 이론(potential theory)에서 라플라스 방정식(Laplace's equation) $\grad^2 \varphi = \upDelta \varphi = 0$을 풀 때 등장한다. 이때 $\upDelta = \grad^2$는 라플라스 연산자이며 $\varphi$는 스칼라 함수이다.}:
    \begin{equation} \label{eq:legendre}
        (1 - x^2)y'' - 2xy' + \alpha(\alpha + 1)y = 0
    \end{equation}
    이는 $x = 0$에서 정칙이기 때문에 $x = 0$에서 멱급수 전개를 할 수 있다.
    따라서 $y = \sum^{\infty}_{n = 0} a_n x^n$으로 놓으면,
    \begin{align*}
        \alpha (\alpha + 1) y &= \sum^{\infty}_{n = 0} \alpha (\alpha + 1) a_n x^n\\
        xy' &= \sum^{\infty}_{n = 0} n a_n x^n\\
        (1 - x^2) y'' &= \sum^{\infty}_{n = 0} \bigl((n + 2)(n + 1) a_{n + 2} - n(n - 1) a_n \bigr) x^n
    \end{align*}
    이고 식~\ref{eq:legendre}에 대입하면
    \begin{align*}
        &(1 - x^2)y'' - 2xy' + \alpha (\alpha + 1) y\\
        = &\sum^{\infty}_{n = 0} \bigl((n + 2)(n + 1) a_{n + 2} - n(n - 1) a_n - 2na_n + \alpha (\alpha + 1) a_n \bigr) x^n\\
        = &\sum^{\infty}_{n = 0}\bigl((n + 2)(n + 1) a_{n + 2} - (n - \alpha)(n + \alpha + 1)a_n + \alpha (\alpha + 1) a_n \bigr) x^n\\
        = &0
    \end{align*}
    가 된다.
    그러므로
    \begin{equation} \label{eq:legendre_recur}
        a_{n + 2} = \frac{(n + \alpha + 1)(n - \alpha)}{(n + 2)(n + 1)} a_n \qquad \text{where } n \in \mathbb N \cup \{0\}
    \end{equation}
    이며,
    \begin{equation*}
        \lim_{n \to \infty} \abs{\frac{a_{n + 1}}{a_n}} = 1
    \end{equation*}
    이므로 $\abs{x} < 1$에서 성립한다.
    만약 $\alpha$가 음이 아닌 정수 $m$일 경우 식~\ref{eq:legendre_recur}의 점화식에서
    \begin{equation*}
        \forall k \geq 0 \qquad a_{m + 2k} = 0
    \end{equation*}
    이 된다.
    즉 르장드르 미분방정식에서 $\alpha = m$일 때에는 $m$차 다항식 $P_m(x)$을 한 해로 가진다.\footnote{다항식이 아닌 다른 해를 제2종 르장드르 함수 $Q_m(x)$라고 한다.}
    계산의 편의상
    \begin{equation} \label{eq:legendre_poly_mth}
        a_m = \frac{(2m)!}{2^m (m!)^2} = \frac{1 \cdot 3 \cdot 5 \cdots (2m - 1)}{m!} 
    \end{equation}
    으로 두고 식~\ref{eq:legendre_recur}를
    \begin{equation*}
        a_n = \frac{(n + 1)(n + 2)}{(n + m + 1)(n - m)} a_{n + 2}
    \end{equation*}
    로 다시 쓰면,
    \begin{align*}
        a_{m - 2} &= \frac{(m - 1) m}{(2m - 1)(-2)} a_m\\
        a_{m - 4} &= \frac{(m - 3)(m - 2)}{(2m - 3)(-4)} a_{m - 2} = \frac{(m - 3)(m - 2)(m - 1)m}{(2m - 3)(2m - 1)(-2)(-4)} a_m\\
                  &\vdotswithin{=}\\
        a_{m - 2k} &= \frac{\overbrace{m \dots (m - 2k + 1)}^\text{$2k$개}}{\underbrace{(2m - 1) \dots (2m - 2k + 1)}_\text{$k$개} \underbrace{(-2) \dots (-2k)}_\text{$k$개}} a_m\\
                   &= (-1)^k \frac{(m!)^2 (2m - 2k)!}{2^m k!\, (2m)!\, (m - k)!\, (m - 2k)!} a_m
    \end{align*}
    이 된다.
    따라서 식~\ref{eq:legendre_poly_mth}를 대입하면
    \begin{equation*}
    a_{m - 2k} = (-1)^k \frac{(2m - 2k)!}{2^m k!\, (m - k)!\, (m - 2k)!} = \frac{(-1)^k}{2^m}\binom{m}{k} \binom{2m - 2k}{m}
    \end{equation*}
    이다.
    그러므로 $P_m(x)$는 다음과 같이 정리할 수 있다:
    \begin{equation} \label{eq:legendre_poly}
        P_m(x) = \frac{1}{2^m} \sum^{\left\lfloor\frac m2\right\rfloor}_{k = 0} (-1)^k \binom{m}{k} \binom{2m - 2k}{m} x^{m - 2k}
    \end{equation}
\end{example}

\begin{remark}
    식~\ref{eq:legendre_poly}의 르장드르 다항식 $P_m(x)$는
    \begin{equation} \label{eq:rodrigues}
        P_m(x) = \frac{1}{2^m m!} \dv[m]{x}(x^2 - 1)^m
    \end{equation}
    로 구할 수 있다.
    위의 식~\ref{eq:rodrigues}\은 로드리게스 공식(Rodrigues' formula)이라고 부른다.
    이를 통해 르장드르 다항식을 쉽게 구할 수 있는데, 몇 개만 구해보자면
    \begin{align*}
        P_0(x) &= 1\\
        P_1(x) &= x\\
        P_2(x) &= \frac 12 (3x^2 - 1)\\
        P_3(x) &= \frac 12 (5x^3 - 3x)
    \end{align*}
    와 같다.
\end{remark}

\begin{remark}
    두 함수 $f$와 $g$에 대해서 내적 $\langle \cdot, \cdot \rangle$을
    \begin{equation} \label{eq:inner_prod_function}
        \langle f, g \rangle = \int^1_{-1} fg \dd{x}
    \end{equation}
    와 같이 정의하면, $n > m$인 경우에 르장드르 다항식 $P_n(x)$와 $P_m(x)$의 내적은
    \begin{align*}
        \bigl\langle P_n(x), P_m(x) \bigr\rangle &= \int^1_{-1} P_n(x) P_m(x) \dd{x}\\
                                                 &= \frac{1}{2^n n!\, 2^m m!} \int^1_{-1} \dv[n]{x} (x^2 - 1)^n \dv[m]{x} (x^2 - 1)^m \dd{x}
    \end{align*}
    으로 쓸 수 있다.
    부분적분을 통해
    \begin{align*}
        &\int^1_{-1} \dv[n]{x} (x^2 - 1)^n \dv[m]{x} (x^2 - 1)^m \dd{x}\\
        = & \left.\dv[n-1]{x} (x^2 - 1)^n \dv[m]{x} (x^2 - 1)^m \right|^1_{-1} - \int^1_{-1} \dv[n-1]{x} (x^2 - 1)^n \dv[m + 1]{x} (x^2 - 1)^m \dd{x}\\
        = &\ 0 - \int^1_{-1} \dv[n-1]{x} (x^2 - 1)^n \dv[m + 1]{x} (x^2 - 1)^m \dd{x}
    \end{align*}
    임을 알 수 있다.\footnote{$f(x) = (x - a)^p (x - b)^q$에 대해서 $n < \min \{p, q\}$일 때 $f^{(n)}(x)$는 $(x - a)(x - b)$를 인수로 가진다. 따라서 이 경우에 $\dv[n - 1]{x} (x^2 - 1)^n$은 $(x - 1)(x + 1) = x^2 - 1$을 인수로 가진다.}
    이를 반복하면
    \begin{align*}
        &\int^1_{-1} \dv[n]{x} (x^2 - 1)^n \dv[m]{x} (x^2 - 1)^m \dd{x}\\
    = & - \int^1_{-1} \dv[n-1]{x} (x^2 - 1)^n \dv[m + 1]{x} (x^2 - 1)^m \dd{x}\\
    = & \int^1_{-1} \dv[n-2]{x} (x^2 - 1)^n \dv[m + 2]{x} (x^2 - 1)^m \dd{x}\\
    \vdots \, &\\
    = &\ (-1)^{n - 1} \int^1_{-1} \dv{x} (x^2 - 1)^n \dv[m + n - 1]{x} (x^2 - 1)^m \dd{x}\\
    = &\ (-1)^n \int^1_{-1} (x^2 - 1)^n \dv[m + n]{x} (x^2 - 1)^m \dd{x}\\
    = &\ (-1)^n \int^1_{-1} (x^2 - 1)^n \cdot 0 \dd{x} = 0
    \end{align*}
    이므로
    \begin{equation*}
        \bigl\langle P_n(x), P_m(x) \bigr\rangle = \frac{1}{2^n n!\, 2^m m!} \int^1_{-1} \dv[n]{x} (x^2 - 1)^n \dv[m]{x} (x^2 - 1)^m \dd{x} = 0
    \end{equation*}
    이다.
    따라서 일반적으로 $n \neq m$일 경우에 $P_n(x)$와 $P_m(x)$가 직교한다.
\end{remark}

\begin{remark}
    식~\ref{eq:inner_prod_function}\와 같이 내적을 정의하면 르장드르 다항식 $P_n(x)$의 노름 $\norm{P_n(x)}$을 구할 수 있다:
    \begin{align}
        \norm{P_n(x)}^2 &= \frac{1}{(2^n n!)^2} \int^1_{-1} \dv[n]{x} (x^2 - 1)^n \dv[n]{x} (x^2 - 1)^n \dd{x} \nonumber \\
                        &\vdotswithin{=}\nonumber \\
                        &= \frac{(-1)^n}{(2^n n!)^2} \int^1_{-1} (x^2 - 1)^n \dv[2n]{x} (x^2 - 1)^n \dd{x}\nonumber \\
                        &= \frac{1}{2^{2n} (n!)^2} \int^1_{-1} (1 - x^2)^n \cdot (2n)! \dd{x}\nonumber \\
                        &= \frac{(2n)!}{2^{2n} (n!)^2} \int^1_{-1} (1 - x^2)^n \dd{x}\label{eq:legendre_norm_temp}
    \end{align}
    여기서 $\int^1_{-1} (1 - x^2)^n \dd{x}$는 다시 부분적분으로 구할 수 있다:
    \begin{align*}
        \int^1_{-1} (1 - x^2)^n \dd{x} &= \int^1_{-1} (1 - x)^n (1 + x)^n \dd{x}\\
                                       &= \left.\frac{(1 - x)^n (1 + x)^{n + 1}}{n + 1} \right|^1_{-1} + \frac{n}{n + 1} \int^1_{-1} (1 - x)^{n - 1} (1 + x)^{n + 1} \dd{x}\\
                                       &= 0 + \frac{n}{n + 1} \int^1_{-1} (1 - x)^{n - 1} (1 + x)^{n + 1} \dd{x}\\
                                       &\vdotswithin{=}\\
                                       &= \frac{n \cdot (n - 1) \cdots 2 \cdot 1}{(n + 1) \cdot (n + 2) \cdots (2n - 1) \cdot 2n} \int^1_{-1} (1 + x)^{2n} \dd{x}\\
                                       &= \frac{(n!)^2}{(2n)!} \left. \frac{(1 + x)^{2n + 1}}{2n + 1} \right|^1_{-1} = \frac{2^{2n + 1} (n!)^2}{(2n + 1)!} 
    \end{align*}
    따라서 식~\ref{eq:legendre_norm_temp}에 대입하면
    \begin{equation*}
        \norm{P_n(x)}^2 = \frac{(2n)!}{2^{2n} (n!)^2} \int^1_{-1} (1 - x^2)^n \dd{x} = \frac{(2n)!}{2^{2n} (n!)^2} \frac{2^{2n + 1} (n!)^2}{(2n + 1)!} = \frac{2}{2n + 1}
    \end{equation*}
    이 되어, 르장드르 다항식의 노름 $\norm{P_n(x)}$는
    \begin{equation*}
        \norm{P_n(x)} = \sqrt{\frac{2}{2n + 1}}
    \end{equation*}
    이다.
\end{remark}
\end{document}
