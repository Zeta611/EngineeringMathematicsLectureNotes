\documentclass[unfonts,oneside,a4paper]{oblivoir}

\usepackage{kotex}
\usepackage{microtype}
\usepackage{bm}

\usepackage{mathpazo}
\setmainfont{TeX Gyre Pagella}
\setmainhangulfont[ItalicFont={*},ItalicFeatures={FakeSlant=.167}]{NanumMyeongjo}
\usepackage{anyfontsize}

\usepackage{amsmath,mathtools,amssymb,amsthm,thmtools}

\theoremstyle{definition}
\newtheorem{definition}{정의}

\theoremstyle{theorem}
\newtheorem{theorem}{정리}

\theoremstyle{theorem}
\newtheorem{lemma}{도움정리}

\theoremstyle{remark}
\newtheorem*{remark}{참고}

\theoremstyle{remark}
\newtheorem*{myremark}{나의 참고}

\theoremstyle{remark}
\newtheorem*{example}{예시}

\theoremstyle{remark}
\newtheorem*{homework}{숙제}

\renewcommand*{\proofname}{증명}

\declaretheoremstyle[
spaceabove=6pt, spacebelow=6pt,
headfont=\normalfont\itshape,
notefont=\mdseries, notebraces={(}{)},
bodyfont=\normalfont,
postheadspace=1em,
headpunct={.},
qed=$\blacksquare$,
numbered=no
]{solstyle}
\declaretheorem[style=solstyle,name=풀이]{solution}

\usepackage{diffcoeff}
\diffset[roman = true]

\renewcommand{\vec}[1]{\bm{\mathit{#1}}}
\newcommand{\vecz}{\bm{\mathrm{0}}}
\newcommand{\dd}{\mathrm{d}}
\DeclareMathOperator{\Span}{Span}
\DeclareMathOperator{\Null}{N}
\DeclareMathOperator{\Image}{Im}
\DeclareMathOperator{\Range}{R}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\Vol}{Vol}
\DeclareMathOperator{\sVol}{\widetilde{Vol}}

\makeatletter
\newcommand\nextitem[1]{%
    \setcounter{\@enumctr}{#1}%
    \addtocounter{\@enumctr}{-1}%
}
\makeatother

\title{공학 수학\\강의 노트}

\author{이재호\\\href{mailto:jaeho.lee@snu.ac.kr}{\texttt{jaeho.lee@snu.ac.kr}}}

\date{마지막 수정: \today}

\begin{document}

\maketitle

\setcounter{section}{6}
\reversemarginpar{}
\section{Linear Algebra: Matrices, Vectors, Determinants. Linear Systems}

Field는 수학과 물리학에서 지칭하는 대상이 다르다:\marginpar{\small2018년 9월 3일}
\begin{itemize}
    \item \textbf{체體}: 실수체, 복소수체
    \item \textbf{장場}: 전자기장, 벡터장
\end{itemize}

\begin{definition}
    체는 $+, -, \times, \div$에 대해 닫혀 있는 수 집합을 말한다.
\end{definition}

\begin{example}
    \leavevmode
    \begin{itemize}
        \item $\mathbb Q$는 조밀(dense)하다.
        \item $\mathbb R$은 꽉차(complete)있다.
        \item $\mathbb C$는 대수적으로 닫혀(closed)있다.
        \item $\mathbb Q \bigl(\sqrt 2\bigr) = \bigl\{a + b \sqrt 2\,\bigm|\,a, b \in \mathbb Q\bigr\}$
        \item $\mathbb Z_p = \{0, 1, \dots, p - 1\}$
    \end{itemize}
\end{example}

\begin{definition}
    벡터공간은 (roughly) 덧셈($+$)과 (어떤 체에 속하는) 상수배가 정의된 집합이다.
\end{definition}

\begin{example}
    \leavevmode
    \begin{itemize}
        \item $\mathbb R^2 = \left\{\begin{pmatrix} a \\ b \end{pmatrix}\,\middle|\,a, b \in \mathbb R\right\}$은 덧셈에 대해 닫혀 있고, $k \in \mathbb R$의 곱에 대해 닫혀 있으므로 실수체에 대한 벡터공간이다.
        \item $\mathbb R^n$과 $\mathbb C^n$은 실수체에 대한 벡터공간이면서 유리수체에 대한 벡터공간이다.
            이를 각각 $\mathbb Q$--벡터공간, $\mathbb R$--벡터공간이라고 한다.
        \item $\mathcal C^0_I = \{f: I \rightarrow \mathbb R \mid f \text{는 연속 함수},\ I \subset \mathbb R\}$에서는, $x \mapsto \sin x$가 하나의 벡터이다.
        \item $\mathcal C^n_I = \bigl\{f: I \rightarrow \mathbb R\,\bigm|\,\exists f^{(n)},\ f^{(n)} \text{는 연속 함수},\ I \subset \mathbb R\bigr\}$이며, $\mathcal C^0_I > \mathcal C^1_I > \dots > \mathcal C^\infty_I$이다.
    \end{itemize}
\end{example}

\setcounter{definition}{1}
\begin{definition}
    체 $F$에 대한 벡터공간 $V$의 원소 $\vec v_1, \dots, \vec v_n \in V$에 대해서,
    \begin{enumerate}
        \item $c_1, \dots, c_k \in F$일 때
            \[
                c_1 \vec v_1 + \dots + c_k \vec v_k
            \]
            는 $\vec v_1, \dots, \vec v_k$의 일차결합, 혹은 선형결합(linear combination)이라고 한다.
        \item $\vec v_1, \dots, \vec v_k$의 선형 생성
            \[
                \Span \{\vec v_1, \dots, \vec v_k\} = \left< \vec v_1, \dots, \vec v_k \right>
            \]
            은 모든 일차결합의 집합이다.
            예를 들어, 어떤 평면 상의 평행하지 않은 두 벡터는 그 평면을 선형 생성한다.
        \item $W \subset V$이면서 $W$가 벡터공간이면, $W$는 $V$의 부분공간이라고 하며 $W < V$로 표기한다.
            예를 들어, 실수 평면으로 나타내어지는 $\mathbb R^2$ 벡터공간의 부분집합인 원점을 지나는 직선은 벡터공간이므로 부분공간이다.
            반면, 원점을 지나지 않는 직선은 부분집합이지만 벡터공간은 아니므로 부분공간이 아니다.
        \item $W = \Span \{\vec v_1, \dots, \vec v_k\} < V$일 때, $\vec v_1, \dots, \vec v_k$는 $W$의 생성자(generator)라고 한다.
        \item $\vec v_1, \dots, \vec v_k$가 일차종속(linearly dependent)라는 것은 어느 하나가 다른 벡터들의 일차결합이라는 것이다.
            일차종속이 아니면 일차독립(linearly independent)이라고 한다.
            예를 들어, $\mathbb R^3$에서 $(1, 2, 3), (4, 5, 6), (7, 8, 9)$는 일차종속인 반면, $(1, 2, 3), (4, 5, 6)$은 일차독립이다.
    \end{enumerate}
\end{definition}

\begin{theorem}
    체\marginpar{\small 2018년 9월 5일} $F$에 대한 벡터공간 $V$의 원소들 $\vec v_1, \dots, \vec v_k$가 일차독립이라는 것은, $c_1, \dots, c_k \in F$일 때
    \[
        c_1 \vec v_1 + \dots + c_k \vec v_k = \vecz\ \Rightarrow\ c_1 = \dots = c_k = 0
    \]
    이라는 것과 동치이다.
\end{theorem}

\begin{proof}
    $(\Rightarrow)$ (재배열 가능하여) $c_k \neq 0$이라고 가정하자.
    그렇다면,
    \[
        \vec v_k = - \left(\frac{c_1}{c_k} \vec v_1 + \dots + \frac{c_{k - 1}}{c_k} \vec v_{k - 1}\right)
    \]
    이므로 $\vec v_1, \dots, \vec v_k$가 일차독립이라는 가정에 모순된다.

    $(\Leftarrow)$ $\vec v_1, \dots, \vec v_k$가 일차종속이라고 가정하자.
    즉, (재배열 가능하여) 어떤 $a_1, \dots, a_{k - 1} \in F$가 존재해서,
    \[
        \vec v_k = a_1 \vec v_1 + \dots + a_{k - 1} \vec v_{k - 1}
    \]
    이다.
    그렇다면
    \[
        a_1 \vec v_1 + \dots + a_{k - 1} \vec v_{k - 1} + (-1) \vec v_k = \vecz
    \]
    이므로 모순이다.
\end{proof}

\begin{example}
    \leavevmode
    \begin{itemize}
        \item $a, b, c \in \mathbb R$에 대해
            \[
                a(1, 2, 3) + b(4, 5, 6) + c(7, 8, 10) = (0, 0, 0)
            \]
            을 만족하는 $a, b, c$는 0밖에 없으므로 $(1, 2, 3), (4, 5, 6), (7, 8, 10)$은 일차독립이다.
        \item $\vecz, \vec v_1, \dots, \vec v_k$는 일차종속이다.
        \item $\vec v_1, \vec v_2, \vec v_3, \vec v_4$가 일차독립이면 $\vec v_1, \vec v_2, \vec v_3$ 또한 일차독립이다.
            ($\vec v_1, \vec v_2, \vec v_3$ 가 종속이면 $\vec v_3 = c_1 \vec v_1 + c_2 \vec v_2 + 0 \vec v_4$이기 때문이다.)
    \end{itemize}
\end{example}

\begin{definition}
    벡터공간 $V$의 부분공간 $W$가 일차독립인 $\vec v_1, \dots, \vec v_k$에 의해 생성될 때, $\{ \vec v_1, \dots, \vec v_k\}$를 $W$의 기저(basis)라고 한다.
\end{definition}

\begin{theorem}[차원(dimension) 정리] \label{thm:dimension}
    $W$가 유한생성된(finitely generated) (부분)공간이면 $W$의 기저의 원소의 개수는 동일하다.
    이 때, 기저의 원소 개수를 $W$의 차원(dimension)이라고 하며, $\dim W$로 표기한다.
\end{theorem}

\begin{example}
    \leavevmode
    \begin{itemize}
        \item $\mathcal P_n = \left\{n\text{차 이하 실계수 다항식}\right\}$일 때, $f \in \mathcal P_n$는 항상 $\mathcal B = \{1, x, \dots, x^n\}$의 원소의 상수배의 합으로 나타낼 수 있다.
            또한,
            \[
                c_0 \cdot 1 + c_1 x + \dots + c_n x^n = 0
            \]
            이면 $c_0 = \dots c_n = 0$이므로, $\mathcal B$는 기저이다.
        \item $\mathcal P = \left\{\text{모든 다항식}\right\}$의 기저는 $\left\{1, x, x^2, \dots\right\}$이며 $\dim \mathcal{P} = \infty$이다.
    \end{itemize}
\end{example}

\begin{homework}
    \leavevmode
    \begin{enumerate}
        \item $a_1, a_2, a_3$는 서로 다른 실수이다.
            이 때, $\left(1, a_1, a_1^2\right), \left(1, a_2, a_2^2\right), \left(1, a_3, a_3^2\right)$이 일차독립임을 보여라.
        \item $a_1, \dots, a_n$는 서로 다른 실수이다.
            이 때, $\left(1, a_1, a_1^2\right), \dots, \left(1, a_n, a_n^2\right)$이 일차독립임을 보여라.
    \end{enumerate}
\end{homework}

\begin{theorem}\label{thm:independence}
    체 F에 대한 벡터공간 $V$의 일차독립인 $\vec v_1, \dots, \vec v_k$에 대해서, $\vec w \in V \setminus \left<\vec v_1 , \dots, \vec v_k\right>$이면 $\vec v_1, \dots, \vec v_k, \vec w$는 일차독립이다.
\end{theorem}

\begin{proof}
    $c_1, \dots, c_k, a \in F$일 때,
    \[
        c_1 \vec v_1 + \dots + c_k \vec v_k + a \vec w = \vecz
    \]
    이라고 가정하자.
    만약 $a \neq 0$이라면 
    \[
        \vec w = -\left(\frac{c_1}{a} \vec v_1 + \dots + \frac{c_k}{a} \vec v_k\right) \in \left<\vec v_1, \dots, \vec v_k\right>
    \]
    이므로 모순이다.
    따라서 $a = 0$이며, $\vec v_1, \dots, \vec v_k$는 일차독립이므로 $c_1 = \dots = c_k = a = 0$이다.
    그러므로 $\vec v_1, \dots, \vec v_k, \vec w$는 일차독립이다.
\end{proof}

Theorem~\ref{thm:independence}에 따르면, 일차독립인 벡터들의 선형 생성에 포함되지 않는 벡터 또한 이들과 일차독립이다.
이에 따라 어떤 유한생성된 벡터공간 $V$의 일차독립인 벡터들 $\vec v_1, \dots, \vec v_k$가 주어졌을 때, 선형 생성에 속하지 않는 벡터 $\vec w_{k + 1}, \dots, \vec w_{\dim V}$를 순차적으로 추가해서 기저를 구성할 수 있다.
이를 기저 확장(basis extension)이라고 부른다.

\begin{theorem} \label{thm:intersection}
    체 $F$에 대한 벡터공간 $V$의 부분공간 $W_1, W_2$가 주어졌을 때, $W_1 \cap W_2$ 또한 $V$의 부분공간이다.
\end{theorem}

\begin{proof}
    $\vec v_1, \vec v_2 \in W_1$이면서 $\vec v_1, \vec v_2 \in W_2$이면, 각각 벡터공간이므로 임의의 $c_1, c_2 \in F$에 대해서 $c_1 \vec v_1 + c_2 \vec v_2 \in W_1$이면서 $c_1 \vec v_1 + c_2 \vec v_2 \in W_2$이다.
    즉,
    \[
        \vec v_1, \vec v_2 \in W_1 \cap W_2\ \Rightarrow\ \forall c_1, c_2 \in F \quad c_1 \vec v_1 + c_2 \vec v_2 \in W_1 \cap W_2
    \]
    이다.
    따라서, $W_1 \cap W_2 < V$가 성립한다.
\end{proof}

\begin{definition}
    벡터공간 $V$의 부분집합 $W_1, W_2$에 대해서 $W_1 + W_2$를 다음과 같이 정의한다:
    \[
        W_1 + W_2 := \{\vec v_1 + \vec v_2 \mid \vec v_1 \in W_1, \vec v_2 \in W_2\}.
    \]
\end{definition}

\begin{example}
    좌표 평면으로 나타내어지는 벡터공간 $\mathbb R^2$의 부분집합(이면서 부분공간인)인 원점을 지나는 직선을 $W_1$이라고 하자.
    원점이 아닌 한 점만을 원소로 하는 집합 $W_2 \subset \mathbb R^2$가 주어졌을 때, $W_1 + W_2$는 $W_1$의 직선을 $W_2$의 (유일한) 원소의 점으로 평행 이동한 직선을 나타낸다.
\end{example}

\begin{theorem} \label{thm:addition}
    체 $F$에 대한 벡터공간 $V$의 부분공간 $W_1$과 $W_2$에 대해서, $W_1 + W_2$도 $V$의 부분공간이다.
\end{theorem}

\begin{proof}
    임의의 $\vec v_1 \in W_1 + W_2$에 대해 어떤 $\vec w_1 \in W_1$과 $\vec w_2 \in W_2$가 존재하며, 마찬가지로 임의의 $\vec v_2 \in W_1 + W_2$에 대해 어떤 $\vec u_1 \in W_1$과 $\vec u_2 \in W_2$가 존재한다.
    $W_1$과 $W_2$는 부분공간이므로 임의의 $c_1, c_2 \in F$에 대해
    \begin{align*}
        c_1 \vec w_1 + c_2 \vec w_2 &\in W_1\\
        c_1 \vec u_1 + c_2 \vec u_2 &\in W_2
    \end{align*}
    이고,
    \begin{equation*}
        c_1 \vec v_1 + c_2 \vec v_2 = (c_1 \vec w_1 + c_2 \vec w_2) + (c_1 \vec u_1 + c_2 \vec u_2)
    \end{equation*}
    이므로,
    \begin{equation*}
        c_1 \vec v_1 + c_2 \vec v_2 \in W_1 + W_2
    \end{equation*}
    이다.
    따라서 $W_1 + W_2 < V$이다.
\end{proof}

\begin{theorem}[그라스만(Graßmann) 공식] \label{thm:grassmann}
    체\marginpar{\small 2018년 9월 10일} $F$에 대한 유한생성된 벡터공간 $U$와 $W$에 대해, 다음이 성립한다:
    \begin{equation*}
        \dim (U + W) = \dim U + \dim W - \dim (U \cap W).
    \end{equation*}
\end{theorem}

\begin{proof}
    \begin{align*}
        l &= \dim (U \cap W)\\
        n &= \dim U - l\\
        m &= \dim W - l
    \end{align*}
    이라 하고, $U \cap W$의 기저를 $\mathcal B_\cap = \{\vec v_1, \dots, \vec v_l\}$라고 하자.
    $\mathcal B_\cap$을 확장해 $U$의 기저 $\mathcal B_U = \{\vec v_1, \dots, \vec v_l, \vec u_1, \dots, \vec u_n\}$와 $W$의 기저 $\mathcal B_W = \{\vec v_1, \dots, \vec v_l, \vec w_1, \dots, \vec w_m\}$을 구성할 수 있다.

    이제 $\mathcal B_U \cup \mathcal B_W = \{\vec v_1, \dots, \vec v_l, \vec u_1, \dots, \vec u_n, \vec w_1, \dots, \vec w_m\}$\footnote{이를 위해서는 $\vec u_1, \dots, \vec u_n$과 $\vec w_1, \dots, \vec w_m$에 겹치는 원소가 없어야 한다.
    이는 $\mathcal B_\cap = \mathcal B_U \cap \mathcal B_W$와 동치인데, 자명할수도 있겠지만 증명 후에 다루었다.}가 $U + W$의 기저임을 보이자.
    $U + W$의 원소 $\vec v$를 고르면, $\vec v = \vec u + \vec w$가 되는
    \[
        \vec u = a_1 \vec v_1 + \dots + a_l \vec v_l + b_1 \vec u_1 + \dots + b_n \vec u_n
    \]
    와
    \[
        \vec w = a'_1 \vec v_1 + \dots + a'_l \vec v_l + c_1 \vec w_1 + \dots + c_m \vec w_m
    \]
    가 존재하고, 이러한 $a_1, \dots, a_l, b_1, \dots, b_n, a'_1, \dots, a'_l, c_1, \dots, c_m \in F$는 유일하다.
    따라서,
    \begin{align*}
        \vec v &= \vec u + \vec w\\
               &= \left(\sum_{i = 1}^l a_i \vec v_i + \sum_{j = 1}^n b_j \vec u_j\right) + \left(\sum_{i = 1}^l a'_i \vec v_i + \sum_{k = 1}^m c_k \vec w_k\right)\\
               &= \sum_{i = 1}^l \left(a_i + a'_i\right) \vec v_i + \sum_{j = 1}^n b_j \vec u_j + \sum_{k = 1}^m c_k \vec w_k
    \end{align*}
    이므로 $\vec v$는 $\Span (\mathcal B_U \cup \mathcal B_W)$의 원소이고, $\mathcal B_U \cup \mathcal B_W$는 $U + W$를 생성한다.

    이제
    \begin{equation*}
        \sum_{i = 1}^l a_i \vec v_i + \sum_{j = 1}^n b_j \vec u_j + \sum_{k = 1}^m c_k \vec w_k = \vecz
    \end{equation*}
    이라고 하자.
    $\vec u_j$항을 제외하고 모두 우변으로 이항하면
    \begin{equation*}
        \sum_{j = 1}^n b_j \vec u_j = \sum_{i = 1}^l -a_i \vec v_i + \sum_{k = 1}^m -c_k \vec w_k
    \end{equation*}
    이 되고, $\vec z = \sum_{j = 1}^n b_j \vec u_j$라고 두자.
    \begin{align*}
        \sum_{j = 1}^n b_j \vec u_j \in \Span \mathcal B_U = U\\
        \sum_{i = 1}^l -a_i \vec v_i + \sum_{k = 1}^m -c_k \vec w_k \in \Span \mathcal B_W = W
    \end{align*}
    이므로, $\vec z \in U \cap W = \Span \mathcal B_\cap = \left<\vec v_1, \dots, \vec v_l\right>$이다.
    즉
    \[
        \vec z = d_1 \vec v_1 + \dots + d_l \vec v_l
    \]
    이 되는 $d_1, \dots, \vec d_l \in F$가 유일하게 존재한다.
    그런데 $\mathcal B_U$와 $\mathcal B_W$는 일차독립이므로 $j \in \{1, \dots, l\}$에 대해 $b_j = 0$이고 $k \in \{1, \dots, m\}$에 대해 $c_k = 0$이다.
    이에 따라 $\vec z = \vecz$이 되어 $i \in \{1, \dots, l\}$에 대해서도 $a_i = 0$이다.
    그러므로 $\mathcal B_U \cup \mathcal B_W$은 일차독립이다.

    $\mathcal B_U \cup \mathcal B_W$는 $U + W$를 생성하고 일차독립이므로, $U + W$의 기저이다.
    결국
    \begin{align*}
        \dim (U + W) &= |\mathcal B_U \cup \mathcal B_W|\\
                     &= l + n + m\\
                     &= (l + n) + (l + m) - l\\
                     &= \dim U + \dim W - \dim (U \cap W)\qedhere
    \end{align*}
\end{proof}

\begin{myremark}
    위 증명에서 $\mathcal B_\cap = \mathcal B_U \cap \mathcal B_W$임을 보이자.\footnote{참고로, $\mathcal B_U \setminus \mathcal B_W$는 $U \setminus W$의 기저가 아니다.
    $\vecz \in U \cap W$임에 따라 $\vecz \notin U \setminus W$이므로, $U \setminus W$는 벡터공간이 아니기 때문이다.}
    위 증명이 성립하기 위해서는 $\{\vec u_1, \dots, \vec u_n\}$와 $\{\vec w_1, \dots, \vec w_m\}$의 모든 원소가 달라야하기 때문이다.
    먼저 $\mathcal B_\cap \subseteq \mathcal B_U \cap \mathcal B_W$임은 자명하다.
    $\mathcal B_U \cap \mathcal B_W$에 속하는 원소 $\vec x$를 고르자.
    $\mathcal B_U \cap \mathcal B_W \subseteq U \cap W$이므로, $\vec x \in \Span \mathcal B_\cap$이다.
    나아가 $\mathcal B_U$와 $\mathcal B_W$의 원소인 $\vec x$는 $\mathcal B_\cap$의 모든 원소들과 일차독립이므로, $\vec x \in \mathcal B_\cap$이어야 한다.
    따라서 $\mathcal B_U \cap \mathcal B_W \subseteq B_\cap$이다.
\end{myremark}

\begin{definition}
    체 $F$에 대한 벡터공간 $V, W$에서, 임의의 $\vec v_1, \vec v_2 \in V$와 $c_1, c_2 \in F$에 대해
    \begin{equation*}
        L(c_1 \vec v_1 + c_2 \vec v_2) = c_1 L(\vec v_1) + c_2 L(\vec v_2)
    \end{equation*}
    을 만족하는 함수 $L: V \rightarrow W$을 선형변환(linear transformation) 혹은 선형사상(linear map)이라고 한다.
\end{definition}

\begin{example}
    \leavevmode
    \begin{enumerate}
        \item $L: \mathbb R^2 \rightarrow \mathbb R^3$에 대해,
            \begin{equation*}
                L \begin{pmatrix}
                    x \\ y
                    \end{pmatrix} = \begin{pmatrix}
                    x + 2y \\ 3x + 4y \\ 5x + 6y
                    \end{pmatrix} = \begin{pmatrix}
                    6 & 2 \\ 3 & 4 \\ 5 & 6
                    \end{pmatrix} \begin{pmatrix}
                    x \\ y
                \end{pmatrix}
            \end{equation*}
            은 선형변환이다.
        \item $L: \mathbb R^2 \rightarrow \mathbb R^3$에 대해,
            \begin{equation*}
                L \begin{pmatrix}
                    x \\ y
                    \end{pmatrix} = \begin{pmatrix}
                    x + 2y \\ 3x + 4y \\ 5x + 6y + 1
                    \end{pmatrix} = \begin{pmatrix}
                    6 & 2 \\ 3 & 4 \\ 5 & 6
                    \end{pmatrix} \begin{pmatrix}
                    x \\ y
                    \end{pmatrix} + \begin{pmatrix}
                    0 \\ 0 \\ 1
                \end{pmatrix}
            \end{equation*}
            은 선형변환이 아니다.
        \item 어떤 사상 $L: \mathbb R^n \rightarrow \mathbb R^m$이 존재한다는 것은 어떤 $m \times n$ 행렬 $A$가 존재해서 $L(\vec x) = A \vec x$라는 것이다.
        \item $f \mapsto f'$의 미분 연산자 $L: \mathcal C^\infty_I \rightarrow \mathcal C^\infty_I$는 $L(c_1 f_1 + c_2 f_2) = c_1 f'_1 + c_2 f'_2 = c_1 L(f_1) + c_2 L(f_2)$이므로 선형변환이다.
        \item $f(x) \mapsto \int_0^x f(t)\, \dd t$의 적분 연산자 $L: \mathcal C^\infty_I \rightarrow \mathcal C^\infty_I$ 또한 선형변환이다.
    \end{enumerate}
\end{example}

\begin{definition}
    두 벡터공간 $V$와 $W$ 간의 선형변환 $L: V \rightarrow W$에 대해 다음이 정의된다:
    \begin{enumerate}
        \item $L$의 핵(kernel) 혹은 영 공간(null space)\footnote{영 공간이라는 용어는 보통 행렬에 국한되어 사용되고, 핵은 추상적인 선형변환에 대해 많이 사용된다.}
            \begin{equation*}
                \ker L = \Null (L) := \{\vec v \in V \mid L(\vec v) = \vecz\}.
            \end{equation*} 
        \item $L$의 치역(range) 혹은 상(image)\footnote{치역은 정의역의 상이다. 상은 정의역의 부분집합에 대해서도 정의될 수 있다.}
            \begin{equation*}
                \Range (L) = \Image (L) := \{L(\vec v) \mid \vec v \in V\}.
            \end{equation*}
        \item $L$이 일대일 함수(one-to-one function) 혹은 단사 함수(injective function, injection)라는 것은 다음을 의미한다:
            \begin{equation*}
                \forall \vec v_1, \vec v_2 \in V \quad \bigl(L(\vec v_1) = L(\vec v_2)\ \Rightarrow\ \vec v_1 = \vec v_2\bigr)
            \end{equation*}
        \item $L$이 위로의(onto) 함수 혹은 단사 함수(surjective function, surjection)라는 것은 다음을 의미한다:
            \begin{equation*}
                \forall \vec w \in W \quad \exists \vec v \in V \quad L(\vec v) = \vec w
            \end{equation*}
    \end{enumerate}
\end{definition}

\begin{example}
    \leavevmode
    \begin{enumerate}
        \item $L \begin{pmatrix}x \\ y \\ z\end{pmatrix} = \begin{pmatrix}1 & 2 & 3 \\ 4 & 5 & 6 \\ 7 & 8 & 9\end{pmatrix} \begin{pmatrix}x \\ y \\ z\end{pmatrix}$일 때 $\ker L\ \bigl(= \Null (L)\bigr)$을 구하시오.
            \begin{solution}
                \begin{align*}
                    &\begin{pmatrix}
                    1 & 2 & 3 \\ 4 & 5 & 6 \\ 7 & 8 & 9
                    \end{pmatrix}&\rightarrow &\begin{pmatrix}
                    1 & 2 & 3 \\ 0 & -3 & -6 \\ 0 & -6 & -12
                \end{pmatrix}\\
                \xrightarrow{\text{Echelon}} &\begin{pmatrix}
                    1 & 2 & 3 \\ 0 & 1 & 2 \\ 0 & 0 & 0
                    \end{pmatrix}&\xrightarrow{\text{Reduce}} &\begin{pmatrix}
                    1 & 0 & -1 \\ 0 & 1 & 2 \\ 0 & 0 & 0
                \end{pmatrix}
            \end{align*}
            즉
            \begin{equation*}
                \begin{pmatrix}
                    1 & 0 & -1 \\ 0 & 1 & 2 \\ 0 & 0 & 0
                    \end{pmatrix} \begin{pmatrix}
                    x \\ y \\ z
                    \end{pmatrix} = \begin{pmatrix}
                    0 \\ 0 \\ 0
                    \end{pmatrix} \ \Rightarrow \ \begin{pmatrix}
                    x \\ y \\ z
                    \end{pmatrix} = \begin{pmatrix}
                    1 \\ -2 \\ 1
                \end{pmatrix} z
            \end{equation*}
            이 되어, $\Null (L) = \left<(1, -2, 1)\right>$이다.
        \end{solution}

    \item $\Range (L)\ \bigl(= \Image(L)\bigr)$을 구하시오.
        \begin{solution}
            $L \begin{pmatrix}
                x \\ y \\ z
                \end{pmatrix} = \begin{pmatrix}
                1 & 2 & 3 \\ 4 & 5 & 6 \\ 7 & 8 & 9
                \end{pmatrix} \begin{pmatrix}
                x \\ y \\ z
            \end{pmatrix}$이므로,
            \begin{align*}
                L(\vec e_1) &= (1, 4, 7)\\
                L(\vec e_2) &= (2, 5, 8)\\
                L(\vec e_3) &= (3, 6, 9)
            \end{align*}
            가 된다.
            따라서
            \begin{align*}
                \Range (L) &= \{L(x, y, z) \mid (x, y, z) \in V\}\\
                           &= \{L(x \vec e_1 + y \vec e_2 + z \vec e_3) \mid (x, y, z) \in V\}\\
                           &= \{x L(\vec e_1) + y L(\vec e_2) + z L(\vec e_3) \mid (x, y, z) \in V\}\\
                           &= \Span \{L(\vec e_1), L(\vec e_2), L(\vec e_3)\}\\
                           &= \left<(1, 4, 7), (2, 5, 8), (3, 6, 9)\right>\\
                           &= \left<(1, 4, 7), (2, 5, 8)\right>
            \end{align*}
            이다.
        \end{solution}
\end{enumerate}
\end{example}

\begin{theorem} \label{thm:nullspace_range}
    벡터공간 $V$와 $W$간의 선형사상 $L: V \rightarrow W$에 대해 $\Null (L) < V$이고 $\Range (L) < W$이다.
\end{theorem}

\begin{theorem}[계수(rank)--퇴화 차수(nullity) 정리]\label{thm:rank_nullity}
    벡터공간 $V$와 $W$간의 선형사상 $L: V \rightarrow W$에 대해 다음이 성립한다:
    \begin{equation*}
        \dim \Null (L) + \dim \Range (L) = \dim V.\footnote{계수와 퇴화 차수에 대해서는 다음 강좌에 정의한다.}
    \end{equation*}
\end{theorem}

\begin{example}
    이전 예시에서 $\Null (L) = \left<(1, -2, 1)\right>$이고 $\Range (L) = \left<(1, 4, 7), (2, 5, 8)\right>$이므로, $\dim \Null (L) + \dim \Range (L) = 1 + 2 = 3$이 성립한다.
\end{example}

\begin{theorem}
    벡터\marginpar{\small 2018년 9월 12일} 공간 $V$와 $W$간의 선형변환 $L: V \rightarrow W$에 대해서 $\{\vec v_1, \dots, \vec v_n\}$이 $V$의 기저라면,
    \begin{equation*}
        \Range (L) = \Span \{L(\vec v_1), \dots, L(\vec v_n)\}
    \end{equation*}
    이다.
\end{theorem}

\begin{remark}
    위에서 $\{L(\vec v_1), \dots, L(\vec v_n)\}$이 기저일 필요는 없다.
\end{remark}

\begin{theorem}\label{thm:one_to_one_nullspace}
    벡터공간 $V$와 $W$간의 선형변환 $L: V \rightarrow W$가 일대일이라는 것은 $\Null (L) = \{\vecz\}$라는 것과 동치이다.
\end{theorem}

\begin{proof}
    ($\Rightarrow$) $L(\vecz) = \vecz$이고, $L$은 일대일이므로 $L(\vec v) = \vecz$를 만족하는 $\vec v = \vecz$가 유일하다.

    ($\Leftarrow$) $L(\vec v_1) = L(\vec v_2)$인 임의의 $\vec v_1, \vec v_2 \in V$를 고르자.
    그렇다면
    \begin{equation*}
        L(\vec v_1) - L(\vec v_2) = L(\vec v_1 - \vec v_2) = \vecz
    \end{equation*}
    인데, $\Null (L) = \{\vecz\}$이므로 $\vec v_1 - \vec v_2 = \vecz$이다.
    따라서 $\vec v_1 = \vec v_2$이며, $L$은 일대일 함수이다.
\end{proof}

\begin{theorem} \label{thm:one_to_one_range}
    벡터공간 $V$와 $W$간의 선형변환 $L: V \rightarrow W$가 일대일이라는 것은 $\dim \Range (L) = \dim V$라는 것과 동치이다.
\end{theorem}

\begin{proof}
    $L$이 일대일이라는 것은 Theorem~\ref{thm:one_to_one_nullspace}에 따라 $\Null (L) = \{\vecz\}$, 즉 $\dim \Null (L) = 0$이라는 것과 동치이다.\footnote{$\dim \Null (L) = 0\ \Leftrightarrow\ \Null (L) = \{\vecz\}$}
    그런데 Theorem~\ref{thm:rank_nullity}에 따라서 $\dim \Null (L) + \dim \Range (L) = \dim V$이므로, $\dim \Range(L) = \dim V$가 성립한다.
\end{proof}

\begin{theorem} \label{thm:inverse}
    벡터공간 $V$와 $W$간의 선형변환 $L: V \rightarrow W$가 전단사라는 것은 $L$의 역함수 $L^{-1}: W \rightarrow V$가 존재한다는 것과 동치이다.
    이 때, $L^{-1}$도 선형이다.
\end{theorem}

\begin{proof}
    전단사 함수가 역함수를 가진다는 증명은 생략한다.
    $L^{-1}$이 선형임을 보인다.

    $W$에서 두 원소 $\vec w_1$와 $\vec w_2$를 고르자.
    이 때,
    \begin{align*}
        L^{-1}(\vec w_1) &= \vec v_1\\
        L^{-1}(\vec w_2) &= \vec v_2
    \end{align*}
    라고 하자.
    그렇다면 $\vec w_1$과 $\vec w_2$의 선형결합은 다음과 같이 표현된다:
    \begin{align*}
        c_1 \vec w_1 + c_2 \vec w_2 &= c_1 L(\vec v_1) + c_2 L(\vec v_2)\\
                                &= L(c_1 \vec v_1 + c_2 \vec v_2)
    \end{align*}
    양변에 역함수를 취해주면
    \begin{align*}
        L^{-1}(c_1 \vec w_1 + c_2 \vec w_2) &= c_1 \vec v_1 + c_2 \vec v_2\\
                                     &= c_1 L^{-1}(\vec w_1) + c_2 L^{-1}(\vec w_2)
    \end{align*}
    이 되어 $L^{-1}$ 또한 선형변환임을 알 수 있다.
\end{proof}

\begin{definition}
    벡터공간 $V$와 $W$간의 선형변환 $L: V \rightarrow W$에 대해서, $L$의 계수
    \begin{equation*}
        \rank L := \dim \Range(L)
    \end{equation*}
    로 정의한다.
\end{definition}

\begin{theorem} \label{thm:one_to_one_rank}
    벡터공간 $U, V, W$에 대해 선형변환 $L_1: U \rightarrow V$와 $L_2: V \rightarrow W$이 주어졌다고 하자.
    만약 $L_2$가 일대일 함수라면, 다음이 성립한다:
    \begin{equation*}
        \rank (L_2 \circ L_1) = \rank L_1
    \end{equation*}
\end{theorem}

\begin{proof}
    정리~\ref{thm:nullspace_range}에 의해 $\Range(L_1)$은 벡터공간이므로, 선형변환 $\tilde L_2: \Range(L_1) \rightarrow W$를 정의하자:
    \begin{equation*}
        \forall \vec v \in \Range(L_1) < V \qquad \tilde L_2(\vec v) = L_2(\vec v)
    \end{equation*}
    따라서 $\tilde L_2$ 또한 일대일 선형변환임을 알 수 있다.
    정리~\ref{thm:one_to_one_range}에 따라 
    \begin{equation*}
        \dim \Range(\tilde L_2) = \dim \Range(L_1)
    \end{equation*}
    이다.
    그런데
    \begin{align*}
        \Range(\tilde L_2) &= \{\tilde L_2 (\vec v) \mid \vec v \in \Range(L_1)\}\\
                          &= \{L_2(\vec v) \mid \vec v \in \Range(L_1)\}
    \end{align*}
    이고
    \begin{align*}
        \Range(L_2 \circ L_1) &= \{(L_2 \circ L_1) (\vec u) \mid \vec u \in U\}\\
                        &= \{L_2(\vec v) \mid \vec v = L_1(\vec u),\ \vec u \in U\}\\
                        &= \{L_2(\vec v) \mid \vec v \in \Range(L_1)\}
    \end{align*}
    이므로 $\Range(\tilde L_2) = \Range(L_2 \circ L_1)$이다.
    따라서 $\dim \Range(\tilde L_2) = \dim \Range(L_2 \circ L_1) = \dim \Range(L_1)$이 성립한다.
\end{proof}

\begin{remark}
    위 증명에서 $\Range(L_2 \circ L_1)$의 기저와 $\Range(L_1)$의 기저의 개수가 같음을 보이면 되므로 $\Range(L_1)$의 기저 각각에 $L_2$를 취한 벡터들이 다시 $\Range(L_2 \circ L_1)$의 기저가 됨을 보여도 된다.
\end{remark}

\begin{definition}
    $m \times n$ 행렬(matrix)이란, $m$개의 행과 $n$개의 열로 이루어진 원소들의 나열이다:
    \begin{equation*}
        \begin{pmatrix}
            a_{11} & a_{12} & \dots & a_{1n}\\
            a_{21} & a_{22} & \dots & a_{2n}\\
            \vdots & \vdots & \ddots & \vdots\\
            a_{m1} & a_{m2} & \dots & a_{mn}
        \end{pmatrix}
    \end{equation*}
\end{definition}

두 행렬의 곱은 각각의 행렬에 대응되는 선형변환의 합성에 대응된다.
즉, 어떤 선형변환 $L_A: \mathbb R^l \rightarrow \mathbb R^m$이 $\vec x \mapsto A \vec x$로 대응시키고 $L_B: \mathbb R^m \rightarrow \mathbb R^n$이 $A \vec x \mapsto B(A \vec x) = BA \vec x$로 대응시킨다면, $BA$는 $L_B \circ L_A$에 대응된다.

$n \times n$ 행렬 $A, B$에 대해서 $AB = BA = I$이라면, $A = B^{-1}$이고 $B = A^{-1}$이다.
이 때,
\begin{equation*}
    I = \begin{pmatrix}
        1 & 0 & \dots & 0\\
        0 & 1 & \dots & 0\\
        \vdots & \vdots & \ddots & \vdots\\
        0 & 0 & \dots & 1
    \end{pmatrix}
\end{equation*}
을 말한다.

\begin{definition}
    선형변환 $L_A$에 대응되는 행렬 $A$에 대해서, 열공간(column space)은 $A$의 열벡터들의 생성이다.
    이 때 열공간의 차원을 열계수(column rank)라고 부른다.
    마찬가지로, 행공간(row space)은 $A$의 행벡터들의 생성이다.
    이 때 행공간의 차원을 행계수(row rank)라고 부른다.
\end{definition}

\begin{example}
    $A = \begin{pmatrix}
        1 & 2 & 3\\
        4 & 5 & 6\\
        7 & 8 & 9
    \end{pmatrix}$에서 열벡터 $(1, 4, 7)$과 $(3, 6, 9)$는 일차독립이고, $(2, 5, 8)$은 두 벡터의 합의 절반이므로 일차종속이다.
    따라서 열계수는 2이다.
    또한 행벡터 $(1, 2, 3)$과 $(7, 8, 9)$는 일차독립이고, $(4, 5, 6)$은 두 벡터의 합의 절반이므로 일차종속이다.
    따라서 행계수도 2이다.
\end{example}

\begin{theorem} \label{thm:rank_matrix}
    선형변환 $L_A$에 대응되는 행렬 $A$에 대해서, 열공간은 $\Range(L_A)$와 동일하다.
    따라서 열계수는 $L_A$의 계수 $\dim \Range(L_A) = \rank L_A$와 같다.
\end{theorem}

\begin{theorem} \label{thm:rank}
    선형변환 $L_A$에 대응되는 행렬 $A$에 대해서, 열계수와 행계수는 동일하다.
    즉, 열계수와 행계수 모두 $\rank L_A$로 나타내어지며 바로 행렬 $A$를 사용해 $\rank A$라고 쓸 수 있다.
\end{theorem}

두 행을 교환하거나, 어떤 행의 상수배를 다른 행에 더하거나, 한 행에 0이 아닌 상수를 곱하는 연산을 행렬의 기본 행 연산이라고 한다.
마찬가지로 열에 대해서도 기본 열 연산을 정의할 수 있다.

\begin{theorem} \label{thm:elementary_op}
    두 행렬 $A$와 $B$의 곱을 $C$라고 하자.
    행렬 $A$에 기본 행 연산을 취한 새로운 행렬을 $\tilde A$라고 하자.
    행렬 $C$에 동일한 기본 행 연산을 취한 새로운 행렬을 $\tilde C$라고 하면, 여전히 $\tilde A B = \tilde C$가 성립한다.
\end{theorem}

\begin{definition}
    항등행렬 $I$에 기본 행/열 연산을 한 번한 것을 기본 행렬이라고 부른다.
\end{definition}

\begin{example}
    $\begin{pmatrix}
        0 & 1 & 0\\
        1 & 0 & 0\\
        0 & 0 & 1
        \end{pmatrix}, \begin{pmatrix}
        1 & 0 & 0\\
        k & 1 & 0\\
        0 & 0 & 1
        \end{pmatrix}, \begin{pmatrix}
        k & 0 & 0\\
        0 & 1 & 0\\
        0 & 0 & 1
    \end{pmatrix}$은 모두 계수가 3인 기본 행렬들이다.
\end{example}

\begin{theorem} \label{thm:rank_elementary}
    $n \times n$ 기본 행렬의 계수는 $n$이다.
\end{theorem}

\begin{proof}
    $n \times n$ 항등행렬 $I$에 대해서, 각 열벡터를 $\vec e_1, \dots, \vec e_n$이라고 하자.
    이 때 열벡터들은 서로 독립이므로 $\rank I = n$이다.

    $I$에 어떤 기본 열 연산을 하여 기본 행렬 $A$를 만들었다고 하자.
    기본 열 연산이 1. 열의 교환인 경우, 2. 열의 상수배를 하여 다른 열에 더한 경우, 3. 열에 0이 아닌 상수를 곱한 경우에 대해서 생각하자.
    \begin{enumerate}
        \item 열을 교환했을 경우\\
            $i$ 번째 열과 $j$ 번째 열을 교환했다고 하자.
            그렇다면 $A$의 열벡터들은 $\vec e_1, \dots, \vec e_j \text{($i$ 번째)}, \dots, \vec e_i \text{($j$ 번째)}, \dots, \vec e_n$이 된다.
            그런데 $\vec e_1, \dots, \vec e_n$은 순서와 상관없이 일차독립이므로 $A$의 열벡터들도 일차독립이다.
        \item 열의 상수배를 하여 다른 열에 더한 경우\\
            $i$ 번째 열에 $k$배를 하여 $j$ 열에 더했다고 하자.
            ($k \neq 0$이다.)
            그렇다면 $A$의 열벡터들은 $\vec e_1, \dots, \vec e_j + k \vec e_i, \dots, \vec e_n$이 된다.
            다음의 선형결합을 생각하자:
            \begin{equation*}
                c_1 \vec e_1 + \dots + c_j (\vec e_j + k \vec e_1) + \dots + c_n \vec e_n = \vecz
            \end{equation*}
            만약 $c_j$가 0이 아니라면, 다음과 같이 식을 재작성할 수 있다:
            \begin{equation*}
                \vec e_j = -\frac{1}{c_j} \left(c_1 \vec e_1 + \dots + c_{j - 1} \vec e_{j - 1} + c_{j + 1} \vec e_{j + 1} + \dots + c_n \vec e_n\right) + \frac{k}{c_j} \vec e_1
            \end{equation*}
            이 때 $\frac{k}{c_j} \neq 0$이므로 $\vec e_1, \dots, \vec e_n$이 독립이라는 것에 모순이다.
            따라서 $c_j = 0$이다.
            결국,
            \begin{equation*}
                c_1 \vec e_1 + \dots + c_{j - 1} \vec e_{j - 1} + c_{j + 1} \vec e_{j + 1} + \dots + c_n \vec e_n = \vecz
            \end{equation*}
            가 되어, $c_1 = \dots = c_{j - 1} = c_{j + 1} = \dots = c_n = 0$이다.
            그런데 $c_j = 0$이므로 $c_1 = \dots = c_n = 0$이어서, $A$의 열벡터들도 일차독립이다.
        \item 열에 0이 아닌 상수를 곱한 경우\\
            $i$ 번째 열에 $k \neq 0$을 곱했다고 하자.
            그렇다면 $A$의 열벡터들은 $\vec e_1, \dots, k \vec e_i, \vec e_n$이 된다.
            다음의 선형결합을 생각하자:
            \begin{equation*}
                c_1 \vec e_1 + \dots + c_i (k \vec e_i) + \dots + c_n \vec e_n = \vecz
            \end{equation*}
            $\vec e_1, \dots, \vec e_n$의 독립성에 의해 $c_1 = \dots = c_i k = \dots = c_n = 0$이 된다.
            그런데 $k \neq 0$이므로 $c_1 = \dots = c_n = 0$이다.
            따라서 $A$의 열벡터들도 일차독립이다.
    \end{enumerate}
    따라서, $A$의 열공간의 차원은 $n$이고 정리~\ref{thm:rank} 의해 $\rank A = n$이다.
    마찬가지로 기본 행 연산의 경우에도 모든 과정을 행벡터에 대입하여 진행하면 동일하게 계수가 $n$임을 알 수 있다.
\end{proof}

\begin{theorem}\label{thm17}
    어떤 유한생성된 벡터공간 $V$와 부분공간 $W$가 주어졌다고 하자.
    그렇다면, 다음이 성립한다:
    \begin{equation*}
        \dim W = \dim V \Rightarrow W = V
    \end{equation*}
\end{theorem}

\begin{proof}
    $\dim W = \dim V = n$일 때, 벡터공간 $W$의 기저 $\mathcal B = \vec w_1, \dots, \vec w_n$를 구성하자.
    $\vec w_1, \dots, \vec w_n$은 일차독립이고 $V$의 원소이기도 하므로, 기저 확장을 통해 $V$의 기저를 구성할 수 있다.
    그런데 이미 $|\mathcal B| = \dim V$이므로, $\mathcal B$는 $V$의 기저이다.
    따라서 $\Span \mathcal B = W = V$이다.
\end{proof}

\begin{theorem} \label{thm:onto}
    선형변환 $L: V \rightarrow V$에 대해서, 다음의 명제는 동치이다:
    \begin{enumerate}
        \item $L$는 일대일 함수이다.
        \item $L$는 위로의 함수이다.
        \item $\rank L = \dim V$이다.
    \end{enumerate}
\end{theorem}

\begin{proof}
    정리~\ref{thm:one_to_one_range}에 의해 $L$가 일대일 함수라는 것은 $\dim \Range(L) = \dim V$, 즉 $\rank L = \dim V$라는 것과 동치이다.
    따라서 1과 3은 동치이다.

    이제 2와 3이 동치임을 보이자.
    만약 $L$가 위로의 함수이면, 공역과 치역이 동일하다.
    즉, $\Range(L) = V$다.
    따라서 $\rank L = \dim \Range(L) = \dim V$이 성립한다.

    역으로, $\rank L = \dim V$라고 하자.
    $\dim \Range(L) = \dim V$이므로, 정리~\ref{thm17}에 따라 $\Range(L) = V$이다.
    그러므로 $L$는 위로의 함수이다.

    따라서, 1, 2, 3은 모두 동치이다.
\end{proof}

지금까지의 내용을 간략히 요약하고, 약간의 내용을 덧붙인다.\marginpar{\small 2018년 9월 17일}
체란 간단히 가감승제에 대해서 닫힌 집합이고, 벡터공간은 덧셈과 스칼라 곱에 대해 닫힌 집합이다.
또한 일차결합, 일차독립, 일차종속과 기저 등에 대해서 다루었다.

정리에는 기저의 원소의 개수가 항상 일정하다는 정리~\ref{thm:dimension}), 벡터공간의 교집합도 벡터공간이라는 것을 보여주는 정리~\ref{thm:intersection}, 벡터공간의 합 또한 벡터공간이며(정리~\ref{thm:addition}) 그 차원은 각각의 차원의 합에서 교집합의 차원을 제한 것이라는 정리~\ref{thm:grassmann}이 있었다.
어떤 선형사상의 영공간과 치역은 각각 정의역과 공역의 부분공간이며(정리~\ref{thm:nullspace_range}), 그 차원의 합은 정의역의 차원임을 알려주는 정리~\ref{thm:rank_nullity}가 있었다.
또한 행렬의 행계수, 열계수, 그리고 대응되는 선형변환의 계수가 모두 같다는 정리~\ref{thm:rank}가 있었다.

\begin{theorem} \label{thm:image_independence}
    벡터공간 $V$와 $W$간의 선형변환 $L: V \rightarrow W$이 일대일 함수라는 것은 임의의 일차독립인 벡터들 $\vec v_1, \dots, \vec v_k \in V$을 골랐을 때, $L(\vec v_1), \dots, L(\vec v_k)$ 또한 일차독립이라는 것과 동치이다.
\end{theorem}

\begin{proof}
    먼저 $L$이 일대일 함수라고 가정하자.
    임의의 일차독립인 벡터들 $\vec v_1, \dots, \vec v_k$에 선형변환 $L$을 취한 벡터들의 선형결합
    \begin{equation*}
        c_1 L(\vec v_1) + \dots + c_n L(\vec v_n) = \vecz
    \end{equation*}
    를 생각하자.
    그렇다면,
    \begin{equation*}
        L(c_1 \vec v_1 + \dots + c_n \vec v_n) = \vecz
    \end{equation*}
    인데, 정리~\ref{thm:one_to_one_nullspace}에 따라 $\Null(L) = \{\vecz\}$이므로
    \begin{equation*}
        c_1 \vec v_1 + \dots + c_n \vec v_n = \vecz
    \end{equation*}
    임을 알 수 있다.
    그런데 $\vec v_1, \dots, \vec v_n$은 일차독립이므로 $c_1 = \dots = c_n = 0$이다.
    따라서 $L(\vec v_1), \dots, L(\vec v_k)$는 일차독립이다.

    이제 임의의 일차독립인 벡터들 $\vec v_1, \dots, \vec v_k$에 대해서 $L(\vec v_1), \dots, L(\vec v_k)$가 일차독립이라고 가정하자.
    $L(\vec v_1) = L(\vec v_2)$인 $\vec v_1, \vec v_2 \in V$를 고르자.
    그런데 $L(\vec v_1) = L(\vec v_2)$이므로, 가정한 명제의 대우에 따라서 $\vec v_1$과 $\vec v_2$는 일차종속이다.
    따라서
    \begin{equation*}
        c_1 \vec v_1 + c_2 \vec v_2 = \vecz
    \end{equation*}
    인 $(0, 0)$이 아닌 $(c_1, c_2)$가 존재한다.
    일반성을 잃지 않고 $c_1 \neq 0$이라고 하면,
    \begin{equation*}
        \vec v_1 = - \frac{c_2}{c_1} \vec v_2
    \end{equation*}
    가 성립한다.
    그런데 $L(\vec v_1 - \vec v_2) = \vecz$이므로,
    \begin{align*}
        L(\vec v_1 - \vec v_2) &= L\left(-\frac{c_2}{c_1} \vec v_2 - \vec v_2\right)\\
                             &= L\left(-\left(1 + \frac{c_2}{c_1}\right) \vec v_2\right)\\
                             &= -\left(1 + \frac{c_2}{c_1}\right) L(\vec v_2)\\
                             &= \vecz
    \end{align*}
    이다.
    여기서 $L(\vec v_2) = \vecz$일 경우는 모든 벡터에 대한 함숫값이 $\vecz$라는 것이고, 가정이 성립하려면 $V$와 $W$는 자명한 벡터공간 $\{\vecz\}$이어야만 한다.
    이 경우 가능한 선형변환은 유일하며, $\vecz \in V$를 $\vecz \in W$와 대응시키는 일대일(이면서 위로의) 함수이다.
    자명하지 않은 벡터공간의 경우, $\frac{c_2}{c_1} = -1$이어야 하고 따라서 $\vec v_1 = \vec v_2$이다.
    따라서 $L$은 일대일 함수이다.
\end{proof}

\begin{theorem} \label{thm:basis_span}
    체 $F$에 대한 벡터공간 $V$가 $\vec v_1, \dots, \vec v_n$에 의해 생성될 때, $\dim V \leq n$이다.
    만약 $\dim V = n$이라면 $\vec v_1, \dots, \vec v_n$은 기저를 이룬다.\footnote{강의 내용에 없었으나 본인의 필요에 따라 추가하였다.}
\end{theorem}

\begin{proof}
    $\{\vec v_1, \dots, \vec v_n\}$의 부분집합 중 일차독립인 최대인 $\{\vec v_1, \dots, \vec v_r\}$을 고르고, $\mathcal B$라고 쓰자.
    (즉 $r \leq n$이며, 원소의 순서는 재배열되었을 수 있다.)
    $V$의 임의의 원소 $\vec v$에 대해서, $V = \left<\vec v_1, \dots, \vec v_n\right>$이므로
    \begin{equation*}
        \exists c_1, \dots c_n \in F \quad \vec v = c_1 \vec v_1 + \dots + c_n \vec v_n
    \end{equation*}
    이다.
    그런데 $\vec v_{r + 1}, \dots$은 $\mathcal B$와 일차종속이므로 $\vec v_1, \dots, \vec v_r$로 다시 쓸 수 있다.
    (일차독립이라면 해당 벡터를 $\mathcal B$에 추가하여도 여전히 일차독립이어야 하는데, 그러면 $\mathcal B$가 최대인 일차독립 부분집합이라는 가정에 모순된다.)
    따라서,
    \begin{align*}
        \vec v &= c_1 \vec v_1 + \dots + c_r \vec v_r + c_{r + 1} \vec v_{r + 1} + \dots\\
               &= c_1 \vec v_1 + \dots + c_r \vec v_r + c_{r + 1} \sum_{i = 1}^r \alpha_i \vec v_i + \dots\\
               &= \bigl(c_1 + \alpha_1 (c_{r + 1} + \dots)\bigr) \vec v_1 + \dots + \bigl(c_r + \alpha_r (c_{r + 1} + \dots)\bigr) \vec v_r
    \end{align*}
    로 표현되어 $\Span B = V$이다.
    결국 $\mathcal B$는 $V$의 기저이며, $\dim V = r \leq n$이다.

    이렇게 구성한 $\mathcal B$의 크기가 $n$이라고 하자.
    $\mathcal B \subseteq \{\vec v_1, \dots, \vec v_n\}$인데 $|\mathcal B| = \bigl|\{\vec v_1, \dots, \vec v_n\}\bigr|$이므로, $\mathcal B = \{\vec v_1, \dots, \vec v_n\}$이다.
    따라서, $\vec v_1, \dots, \vec v_n$은 기저를 이룬다.
\end{proof}

\begin{remark} \label{page:equiv_remark}
    지금까지의 내용에 따라서, 벡터공간 $V$와 $W$간의 선형변환 $L$에 대해서 다음의 명제들은 서로 동치이다:
    \begin{enumerate}
        \item $L$은 일대일 함수이다.
        \item $\Null(L) = \{\vecz\}$이다. (정리~\ref{thm:one_to_one_nullspace})
        \item $\rank L = \dim V$이다. (정리~\ref{thm:one_to_one_range})
        \item 임의의 선형독립인 $\vec v_1, \dots, \vec v_k \in V$에 대해서, $L(\vec v_1), \dots, L(\vec v_n)$도 선형독립이다. (정리~\ref{thm:image_independence})
    \end{enumerate}

    만약 $V = W$이고, $V$가 유한생성된 벡터공간이라면, 다음의 명제들도 위 명제들과 동치이다:
    \begin{enumerate}
        \nextitem{5}
        \item $L$은 위로의 함수이다. (정리~\ref{thm:onto})
        \item $L$은 일대일 대응이다. (1과 5로부터)
        \item $L$은 가역(invertible)이다. (정리~\ref{thm:inverse})
    \end{enumerate}

    나아가 $V = W = \mathbb R^n$일 경우, 선형변환 $L$에 대응되는 $n \times n$ 행렬 $A$가 있어서 다음의 명제들도 위 명제들과 동치이다:
    \begin{enumerate}
        \nextitem{8}
        \item $\forall \vec v \in \mathbb R^n \quad L^{-1}(\vec v) = A^{-1} \vec v$이다. (7로부터)
        \item $A$의 열벡터들은 일차독립이다. (정리~\ref{thm:rank}와 \ref{thm:basis_span})
    \end{enumerate}
\end{remark}

\begin{theorem}
    벡터\marginpar{\small2018년 9월 19일} 공간 $U, V, W$에 대해 선형변환 $L_1: U \rightarrow V$와 $L_2: V \rightarrow W$이 주어졌다고 하자.
    만약 $L_1$가 위로의 함수라면, 다음이 성립한다:
    \begin{equation*}
        \rank (L_2 \circ L_1) = \rank L_2
    \end{equation*}
\end{theorem}

\begin{proof}
    $\Range(L_2 \circ L_1)$은 $L_2 \circ L_1$에 대한 $U$의 상이다.
    즉,
    \begin{align*}
        \Range(L_2 \circ L_1) &= \{(L_2 \circ L_1)(\vec u) \mid \vec u \in U\}\\
                        &= \{L_2(\vec v) \mid \vec v = L_1(\vec u),\ \vec u \in U\}
    \end{align*}
    이다.
    그런데 $L_1$은 위로의 함수이므로
    \begin{equation*}
        \forall \vec v \in V \quad \exists \vec u \in U \quad L_1(\vec u) = \vec v
    \end{equation*}
    가 성립한다.
    따라서
    \begin{equation*}
        \{L_2(\vec v) \mid \vec v = L_1(\vec u),\ \vec u \in U\} = \{L_2(\vec v) \mid \vec v \in V\} = \Range(L_2)
    \end{equation*}
    이다.
    따라서 $\Range(L_2 \circ L_1) = \Range(L_2)$이며, $\rank(L_2 \circ L_1) = \rank L_2$이 성립함을 알 수 있다.
\end{proof}

\begin{theorem} \label{thm:elementary_op_rank}
    $m \times n$ 행렬 $A$의 계수는 기본 행/열 연산에 대해 불변이다.
\end{theorem}

\begin{proof}
    기본 행/열 연산에 대응되는 기본 행렬을 $E$라고 하고, $A$에 기본 행/열 연산을 취한 행렬을 $\tilde A$라고 하면,
    \begin{equation*}
        EA = \tilde A
    \end{equation*}
    이다.
    이 때 $E$는 $m \times n$ 행렬을 $m \times n$ 행렬로 보내는 $m \times m$ 행렬이다.
    각 행렬 $E, A, \tilde A$에 대응되는 행렬을 $L_E, L_A, L_{\tilde A}$라고 하자.
    이 때 $\tilde A = EA$이므로 $L_{\tilde A} = L_E \circ L_A$이다.
    정리~\ref{thm:rank_matrix}와 \ref{thm:rank_elementary}에 따라 $\rank E = \rank L_E = m$이고, 따라서 정리~\ref{thm:one_to_one_nullspace}에 따라 $L_E$는 일대일이다.
    그러므로 정리~\ref{thm:one_to_one_rank}에 의해
    \begin{equation*}
        \rank L_{\tilde A} = \rank (L_E \circ L_A) = \rank L_A
    \end{equation*}
    임을 알 수 있다.
    따라서 정리~\ref{thm:rank_matrix}에 의해 $\rank A = \rank \tilde A$이다.
\end{proof}

\begin{theorem} \label{thm:rowrankinvar}
    $m \times n$ 행렬 $A$의 행계수는 기본 행/열 연산에 대해 불변이다.
\end{theorem}

\begin{proof}
    정리~\ref{thm:rank}에 의해 자명하다.

    혹은, 좀 더 직접적으로 정리~\ref{thm:elementary_op_rank}에서 각 행렬에 전치를 취한 후, 기본 행 연산은 기본 열 연산으로, 기본 열 연산은 기본 행 연산으로 바꾼다면 행계수를 열계수로 바꾸어 생각할 수 있다.
\end{proof}

다음의 연립방정식
\begin{align*}
    x + 2y + 3z &= 6\\
    4x + 5y + 6z &= 15\\
    7x + 8y + 9z &= 24
\end{align*}
은 다음과 같이 행렬로 표현할 수 있다.
\begin{equation*}
    \begin{pmatrix}
        1 & 2 & 3\\
        4 & 5 & 6\\
        7 & 8 & 9
    \end{pmatrix}
    \begin{pmatrix}
        x\\
        y\\
        z
    \end{pmatrix}
    =
    \begin{pmatrix}
        6\\
        15\\
        24
    \end{pmatrix}
\end{equation*}
   정리~\ref{thm:elementary_op}에 의해 $\begin{pmatrix}1&2&3\\4&5&6\\7&8&9\end{pmatrix}$와 $\begin{pmatrix}6\\15\\24\end{pmatrix}$에 동일한 기본 행 연산을 하여도 등식은 성립한다.
   따라서
   \begin{equation*}
        \begin{pmatrix}
            1 & 2& 3\\
            0 & -3 & -6\\
            0 & 0 & 0
        \end{pmatrix}
        \begin{pmatrix}
            x\\
            y\\
            z
        \end{pmatrix}
        =
        \begin{pmatrix}
            6\\
            -9\\
            0
        \end{pmatrix}
   \end{equation*}
   이 된다.
   위와 같은 형태를 행사다리꼴(row echelon form)이라고 한다.
   여기서 $z$는 유일하게 정해지지 않으므로 $z = a$라고 놓으면, 후진 대입법을 통해서 $y$와 $x$를 구할 수 있다:
   \begin{equation*}
       \begin{pmatrix}
           x\\
           y\\
           z
       \end{pmatrix}
       =
       \begin{pmatrix}
           a\\
           3 - 2a\\
           a
       \end{pmatrix}
       =
       a
       \begin{pmatrix}
           1\\
           -2\\
           1
       \end{pmatrix}
       +
       \begin{pmatrix}
           0\\
           3\\
           0
       \end{pmatrix}.
   \end{equation*}
혹은 여기서 그치지 않고 다음과 같이 기본 행 연산을 더 할 수도 있다:
\begin{equation*}
    \begin{pmatrix}
        1 & 0 & -1\\
        0 & 1 & 2\\
        0 & 0 & 0
    \end{pmatrix}
    \begin{pmatrix}
        x\\
        y\\
        z
    \end{pmatrix}
    =
    \begin{pmatrix}
        0\\
        3\\
        0
    \end{pmatrix}
\end{equation*}
위와 같은 행태를 기약행 사다리꼴(reduced row echelon form)이라고 한다.
여기서 바로 $z = a$로 둔다면, 쉽게 위와 동일한 해를 구할 수 있다.\footnote{사실 동일한 표현이 나오는 것은 특수한 경우지만, 결과적으로는 동일한 해집합을 구하게 된다.}
따라서 해집합은
\begin{equation*}
    \left\{ a
    \begin{pmatrix}
        1\\
        -2\\
        1
    \end{pmatrix}
    +
    \begin{pmatrix}
        0\\
        3\\
        0
    \end{pmatrix}
    \,\middle|\, a \in \mathbb R
    \right\}
\end{equation*}
임을 알 수 있다.

\begin{theorem} \label{thm:nonhomogeneous}
    계수 행렬 $A$와 변수 열벡터 $\vec x$, 그리고 상수 열벡터 $\vec b$가 주어졌을 때, 방정식 $A \vec x = \vec b$의 해집합은
    \begin{equation*}
        \Null(L_A) + \vec x_0
    \end{equation*}
    이 때, $L_A$는 행렬 $A$에 대응되는 선형변환이고, $\vec x_0$는 특수해(particular solution)이다.
\end{theorem}
\begin{proof}
    $\vec x$를 임의의 해, $\vec x_0$를 특수해라고 하자.
    즉,
    \begin{align*}
        A\vec x &= \vec b\\
        A\vec x_0 &= \vec b
    \end{align*}
    이다.
    따라서
    \begin{equation*}
        A(\vec x - \vec x_0) = 0
    \end{equation*}
    과 같이 정리할 수 있고, 정의에 따라 $\vec x - \vec x_0 \in \Null(L_A)$임을 알 수 있다.
    즉 $\vec x \in \Null(L_A) + \vec x_0$이고, 해집합은 $\Null(L_A) + \vec x_0$의 부분집합이다.

    이제 $\Null(L_A) + \vec x_0$의 한 원소 $\vec x$를 고르자.
    즉, $\Null(L_A)$에 속하는 한 원소 $\vec x_h$에 대해서
    \begin{equation*}
        \vec x = \vec x_h + \vec x_0
    \end{equation*}
    를 만족한다.
    양변에 행렬 $A$를 왼쪽에 곱해주면
    \begin{equation*}
        A \vec x = A (\vec x_h + \vec x_0) = A \vec x_h + A \vec x_0
    \end{equation*}
    이다.
    그런데 $\vec x_h \in \Null(L_A)$이므로 $A \vec x_h = \vecz$이고, $\vec x_0$는 특수해이므로 $A \vec x_0 = \vec b$이다.
    따라서
    \begin{equation*}
        A \vec x = \vecz + \vec b
    \end{equation*}
    이어서, $\vec x$는 해집합에 속한다.
    따라서 $\Null(L_A) + \vec x_0$는 해집합의 부분집합이며, 위에서 해집합 또한 $\Null(L_A) + \vec x_0$의 부분집합임을 보였으므로 둘은 같은 집합이다.
\end{proof}

\begin{example}
    방정식 $2x + y = 3$, 혹은
    \begin{equation*}
        \bigl(2 \quad 1\bigr)\,
        \begin{pmatrix}
            x\\
            y
        \end{pmatrix}
        = 3
    \end{equation*}
    의 해는 방정식 $2x + y = 0$의 해를 좌표 평면에 나타냈을 때 그려지는 직선을 평행 이동한 것이다.
    특히 특수해 $(0, 3)$, $\bigl(\frac 32, 0\bigr)$, $(1, 1)$ 등에서 하나를 골라 원래 그래프가 해당 점을 지나도록 평행 이동한 것이다.
\end{example}

정리~\ref{thm:nonhomogeneous}에서 상수 열벡터 $\vec b = \vecz$인 경우의 방정식을 동차 연립 일차 방정식(homogeneous system of linear equations), $\vec b \neq \vecz$인 경우를 비동차 연립 일차 방정(nonhomogeneous system of linear equations)라고 한다.
다음의 동립 연립 일차 방정식
\begin{equation*}
    \begin{pmatrix}
        1 & 2 & 0 & 3 & 1 & 2\\
        0 & 0 & 1 & 0 & 0 & 2\\
        0 & 0 & 0 & 1 & 0 & 1\\
        0 & 0 & 0 & 0 & 1 & 1
    \end{pmatrix}
    \begin{pmatrix}
        x_1\\
        x_2\\
        x_3\\
        x_4\\
        x_5\\
        x_6
    \end{pmatrix}
    =
    \begin{pmatrix}
        0\\
        0\\
        0\\
        0
    \end{pmatrix}
\end{equation*}
을 풀면,
\begin{equation*}
    (x_1, x_2, x_3, x_4, x_5, x_6) = a(2, 0, -2, -1, -1, 1) + b(-2, 1, 0, 0, 0, 0)\quad a, b \in \mathbb R
\end{equation*}
이 해가 된다.
이 때 $a$와 $b$는 자유 변수이다.
따라서, 위 계수 행렬의 영공간은
\begin{equation*}
    \left<(2, 0, -2, -1, -1, 1), (-2, 1, 0, 0, 0, 0)\right>
\end{equation*}
임을 알 수 있다.
여기서 주목할 사실은 변수 벡터의 원소 개수가 6, 즉 차원이 6인 벡터공간에 있다는 것이고, 해공간 혹은 영공간의 차원\footnote{또는 자유변수의 개수, 즉 자유도}이 2라는 것이다.
이 둘의 차이 $6 - 2 = 4$는 계수 행렬의 계수(rank)와 같은데, 이는 우연이 아니라 계수--퇴화 차수 정리(정리~\ref{thm:rank_nullity})에 의한 것이다.

\begin{definition}
    어떤 $n \times n$ 행렬 $A$에 대해서 $n \times n$ 행렬 $B$가 존재해서
    \begin{equation*}
        A B = I
    \end{equation*}
    일 때, $A$를 가역 행렬이라 하고 $B$를 $A$의 역행렬이라고 한다.
\end{definition}

가역 행렬 $A$의 역행렬 $B$를 찾는 것은 식 $AB = I$에서 $A$를 $I$로 만드는 일련의 기본 행연산들을 $A$와 $I$에 동일하게 취하는 것이다.
$I$에 해당 기본 행연산들을 취한 결과를 $C$라고 하면, 식 $AB = I$는 $IB = C$가 된다.
따라서 $C$는 $A$의 역행렬 $B$가 됨을 알 수 있다.

이렇게\marginpar{\small2018년 10월 1일} 역행렬을 구할 수 있으려면 기본 행연산들을 통해 $A$를 $I$로 만들 수 있어야 한다.
그런데 정리~\ref{thm:rowrankinvar}에 따르면 기본 행연산으로 행계수가 바뀌지 않으므로, $A$의 행계수가 $A$의 행/열의 개수와 같지 않으면 $I$로 변형할 수 없다.
따라서, $A$의 역행렬이 존재할 조건은 $A$의 계수가 행/열의 개수와 같은 것이다.

\begin{definition} \label{def:multilin}
    벡터공간 $V_1, \dots, V_n, W$에 대해 어떤 함수 $f: V_1 \times \dots \times V_n \rightarrow W$가 다중선형사상(multilinear map)이라는 것은 모든 $i \in \{1, \dots, n\}$에 대한 $\vec v_i \in V_i$에 대해
    \begin{equation*}
        f(\vec v_1, \dots, c \vec v_i + \tilde c \tilde{\vec v}_i, \dots, \vec v_n) = c f(\vec v_1, \dots, \vec v_i, \dots, \vec v_n) + \tilde c f(\vec v_1, \dots, \tilde{\vec v}_i, \dots, \vec v_n)
    \end{equation*}
    을 만족한다는 것이다.
    즉, 다중선형사상은 각각의 $\vec v_i$에 대해 $f$가 선형사상이다.
\end{definition}

\begin{definition} \label{def:alternating_multilin}
    벡터공간 $V$와 $W$에 대한 다중선형사상 $f: V^n \rightarrow W$가
    \begin{equation*}
        \bigl(\exists i, j \in \{1, \dots, n\} \quad \vec v_i = \vec v_j\bigr) \quad \Rightarrow \quad f(\vec v_1, \dots, \vec v_n) = 0
    \end{equation*}
    를 만족하면 $f$를 교대다중선형사상(alternating multilinear map)이라고 부른다.
\end{definition}

\begin{theorem} \label{thm:skew_sym}
    벡터공간 $V$와 $W$에 대한 교대다중선형사상 $f: V^n \rightarrow W$은 두 벡터를 교환하면 부호가 바뀐다.
    즉,
    \begin{equation*}
        f(\vec v_1, \dots, \vec v_i, \dots, \vec v_j, \dots, \vec v_n) = -f(\vec v_1, \dots, \vec v_j, \dots, \vec v_i, \dots, \vec v_n)
    \end{equation*}
    이다.
\end{theorem}

\begin{proof}
    교대다중선형사상에서 두 벡터가 동일하면 그 함숫값은 0이므로,
    \begin{equation*}
        f(\vec v_1, \dots, \vec v_i + \vec v_j, \dots, \vec v_i + \vec v_j, \dots \vec v_n) = 0
    \end{equation*}
    이다.
    이는 다중선형성에 의해
    \begin{align*}
        &\quad f(\vec v_1, \dots, \vec v_i + \vec v_j, \dots, \vec v_i + \vec v_j, \dots \vec v_n)\\
        &= f(\vec v_1, \dots, \vec v_i, \dots, \vec v_i, \dots \vec v_n) + f(\vec v_1, \dots, \vec v_j, \dots, \vec v_j, \dots \vec v_n)\\
        &\qquad+ f(\vec v_1, \dots, \vec v_i, \dots, \vec v_j, \dots \vec v_n) + f(\vec v_1, \dots, \vec v_j, \dots, \vec v_i, \dots \vec v_n)\\
        &= f(\vec v_1, \dots, \vec v_i, \dots, \vec v_j, \dots \vec v_n) + f(\vec v_1, \dots, \vec v_j, \dots, \vec v_i, \dots \vec v_n)\\
        &= 0
    \end{align*}
    이다.
    따라서,
    \begin{equation*}
        f(\vec v_1, \dots, \vec v_i, \dots, \vec v_j, \dots \vec v_n) = -f(\vec v_1, \dots, \vec v_j, \dots, \vec v_i, \dots \vec v_n)
    \end{equation*}
    를 만족한다.
\end{proof}

\begin{example}
    교대다중선형사상 $f: \mathbb R^2 \times \mathbb R^2 \rightarrow \mathbb R$에 대해서, $f$가 $\begin{pmatrix}a & b \\ c & d\end{pmatrix}$의 열벡터를 인자로 받는다고 하자.
    이를 계산하면
    \begin{align*}
        f
        \begin{pmatrix}
            a & b\\
            c & d
        \end{pmatrix}
        &= f(a \vec e_1 + c \vec e_2, b \vec e_1 + d \vec e_2)\\
        &= ab f(\vec e_1, \vec e_1) + ad f(\vec e_1, \vec e_2) + cb f(\vec e_2, \vec e_1) + cd f(\vec e_2, \vec e_2)\\
        &= (ad - bc) f(\vec e_1, \vec e_2)\\
        &= (ad - bc) f
        \begin{pmatrix}
            1 & 0\\
            0 & 1
        \end{pmatrix}
    \end{align*}
\end{example}

\begin{definition}
    교대다중선형사상 $f: (\mathbb R^n)^n \rightarrow \mathbb R$에 대해서 $n \times n$ 단위행렬 $I$의 함숫값이 1, 즉 $f(I) = 1$이면 $f$를 행렬식(determinant)이라고 하고, $\det$라고 표기한다.
\end{definition}

행렬식을 계산할 때는 다중선형성(정의~\ref{def:multilin}) 및 교대다중선형성(정의~\ref{def:alternating_multilin}와 정리~\ref{thm:skew_sym})에 따라 각 열벡터들의 원소들을 행이 겹치지 않도록 골라서 계산할 수 있다.
예를 들어
\begin{align*}
    \det
    \begin{pmatrix}
        a & b & c\\
        d & e & f\\
        g & h & j
    \end{pmatrix}
    &= aej \det (\vec e_1, \vec e_2, \vec e_3) + bfg \det (\vec e_3, \vec e_1, \vec e_2) + cdh \det (\vec e_2, \vec e_3, \vec e_1)\\
    &\qquad+ bdj \det (\vec e_2, \vec e_1, \vec e_3) + ceg \det (\vec e_3, \vec e_2, \vec e_1) + afh \det (\vec e_1, \vec e_3, \vec e_2)\\
    &= \bigl((aej + bfg + cdh) - (bdj + ceg + afh)\bigr) \det I
\end{align*}
와 같이 계산하면 된다.

\begin{lemma}
    $\Sym\bigl(\{1, 2, \dots, n\}\bigr)$의 항등 순열(permutation) $(1\ 2\ \dots\ n)$의 원소 두 개씩을 서로 교환(transposition)하여 다시 항등 순열을 만들 때, 교환 횟수는 항상 짝수번이다.
\end{lemma}

\begin{theorem}
    $\Sym\bigl(\{1, 2, \dots, n\}\bigr)$의 순열 $\sigma_1$에서 $\sigma_2$를 만드는 교환은 홀짝성을 보존한다.
\end{theorem}

\begin{theorem} \label{thm:det_props}
    $\mathbb R^n$에\marginpar{\small 2018년 10월 5일} 속하는 벡터 $\vec v_1, \dots, \vec v_n$와 $n \times n$ 행렬 $A, B$에 대해서, 다음이 성립한다:
    \begin{enumerate}
        \item $\det(\vec v_1, \dots, \vec v_i, \dots, \vec v_n) = \det(\vec v_1, \dots, \vec v_i + k \vec v_j, \dots, \vec v_n)$
        \item $\det\bigl(A^t\bigr) = \det(A)$
        \item $\det(AB) = \det(A) \det(B)$ \footnote{\text{원래 수업에서는 누락되었던 부분이지만, 2018년 10월 24일 수업에 추가로 언급하신 내용이다.}}
    \end{enumerate}
\end{theorem}

\begin{theorem} \label{thm:ero_det}
    $n \times n$ 행렬 $A$의 행렬식에 대해서,
    \begin{enumerate}
        \item 두 행을 바꾸는 기본 행 연산은 행렬식의 부호를 바꾸며
        \item 어떤 행에 $k$를 곱하는 기본 행 연산은 행렬식의 값에 $k$배를 하며
        \item 어떤 행의 상수 배를 하여 다른 행에 더하는 연산에 대해 불변이다.\footnote{정리~\ref{thm:det_props}의 2에 따라, 정리~\ref{thm:ero_det}의 기본 열 연산 버전을 만들 수 있다.}
    \end{enumerate}
\end{theorem}

\begin{remark}
    행렬식을 계산할 때 다중선형성과 교대다중선형성만을 사용해 계산하면 긴 계산을 거쳐야 하지만, 위의 정리~\ref{thm:ero_det}을 사용하면 계산이 단순해질 수 있다.
    이는 어떤 행렬
    \begin{equation*}
        A =\begin{pmatrix}a&e&f&g\\0&b&h&i\\0&0&c&j\\0&0&0&d\end{pmatrix}
    \end{equation*}
    에 대해서 $\det A = abcd$이기 때문이다.
    따라서, 정리~\ref{thm:ero_det}에 따라 기본 행 연산을 통해 이와 같이 대각선 밑의 모든 원소가 0 (혹은 위의 모든 원소)인 꼴을 만들면 대각선의 곱을 통해 행렬식을 계산할 수 있다.
    이러한 꼴을 상삼각행렬 (혹은 하삼각행렬)이라고 부른다.

    일반적으로 행렬식 계산은 이렇게 상삼각행렬과 하삼각행렬의 곱으로 분해하는 과정(LU 분해)을 통해 행렬을 곱하는데 필요한 시간복잡도와 동일하게 계산할 수 있다.
\end{remark}

\begin{theorem} \label{thm:nonzero_det}
    $n \times n$ 행렬 $A$에 대응되는 선형변환 $L_A$가 일대일 함수라는 것은 $\det A$가 0이 아니라는 것과 동치이다.
\end{theorem}
\begin{proof}
    만약 행렬 $A$에서 어떤 행의 $k$배를 하여 다른 행에 더하는 기본 행 연산을 반복하였을 때 상(하)삼각행렬을 만들었다고 하자.
    상삼각행렬은 다시 어떤 행의 $k$배를 하여 다른 행에 더하는 기본 행 연산을 반복하여 (후진대입을 하는 것과 같이) 대각선 이외의 모든 원소를 0으로 만들 수 있다.
    이렇게 만들어진 행렬을 $\tilde A$라고 하자.
    이 때 정리~\ref{thm:ero_det}에 따라 $\det A = \det \tilde A$이다.

    $\det \tilde A = 0$, 즉 $\tilde A$의 대각선의 한 원소가 0이라고 가정하자.
    이는 $\tilde A$의 열벡터들이 서로 독립이 아니라는 것과 동치이다. ($\tilde A$의 대각선 이외의 모든 원소들은 0이기 때문이다.)
    정리~\ref{thm:elementary_op_rank}에 따라 기본 행 연산을 통해 열벡터들의 독립성이 바뀌지 않으므로, $A$의 열벡터들도 서로 독립이 되지 않는다.
    따라서 $A$에 대응되는 $L_A$는 일대일 함수가 되지 않는다 (\pageref{page:equiv_remark}쪽의 참고 9).
\end{proof}

\begin{remark}
    \pageref{page:equiv_remark}쪽의 참고를 다시 옮긴다.
    벡터공간 $V$와 $W$간의 선형변환 $L$에 대해서 다음의 명제들은 서로 동치이다:
    \begin{enumerate}
        \item $L$은 일대일 함수이다.
        \item $\Null(L) = \{\vecz\}$이다. (정리~\ref{thm:one_to_one_nullspace})
        \item $\rank L = \dim V$이다. (정리~\ref{thm:one_to_one_range})
        \item 임의의 선형독립인 $\vec v_1, \dots, \vec v_k \in V$에 대해서, $L(\vec v_1), \dots, L(\vec v_n)$도 선형독립이다. (정리~\ref{thm:image_independence})
    \end{enumerate}

    만약 $V = W$이고, $V$가 유한생성된 벡터공간이라면, 다음의 명제들도 위 명제들과 동치이다:
    \begin{enumerate}
        \nextitem{5}
        \item $L$은 위로의 함수이다. (정리~\ref{thm:onto})
        \item $L$은 일대일 대응이다. (1과 5로부터)
        \item $L$은 가역(invertible)이다. (정리~\ref{thm:inverse})
    \end{enumerate}

    나아가 $V = W = \mathbb R^n$일 경우, 선형변환 $L$에 대응되는 $n \times n$ 행렬 $A$가 있어서 다음의 명제들도 위 명제들과 동치이다:
    \begin{enumerate}
        \nextitem{8}
        \item $\forall \vec v \in \mathbb R^n \quad L^{-1}(\vec v) = A^{-1} \vec v$이다. (7로부터)
        \item $A$의 열벡터들은 일차독립이다. (정리~\ref{thm:rank}와 \ref{thm:basis_span})
        \item $A \vec x = \vecz$인 $\vec x$가 $\vecz$로 유일하게 존재한다. (정리~\ref{thm:one_to_one_nullspace})
        \item $A \vec x = \vec b$인 $\vec x$가 유일하게 존재한다. (10과 정리~\ref{thm:nonhomogeneous})
        \item $\det A$가 0이 아니다. (정리~\ref{thm:nonzero_det})
    \end{enumerate}
\end{remark}

\begin{theorem} \label{thm:vec_prod_det}
    $\vec a, \vec b, \vec c \in \mathbb R^3$에 대해서 다음이 성립한다:
    \begin{equation*}
        (\vec a \times \vec b) \cdot \vec c = \vec a \cdot (\vec b \times \vec c) = \det(\vec a, \vec b, \vec c)
    \end{equation*}
\end{theorem}
\begin{proof}
    다음과 같이 놓자:
    \begin{align*}
        \vec a &= (a_1, a_2, a_3)\\
        \vec b &= (b_1, b_2, b_3)\\
        \vec c &= (c_1, c_2, c_3)
    \end{align*}
    이 때,
    \begin{equation*}
        \vec a \times \vec b = (a_2 b_3 - a_3 b_2, a_3 b_1 - a_1 b_3, a_1 b_2 - a_2 b_1)
    \end{equation*}
    이며, 따라서
    \begin{align*}
        (\vec a \times \vec b) \cdot \vec c &= (a_2 b_3 - a_3 b_2) c_1 + (a_3 b_1 - a_1 b_3) c_2 + (a_1 b_2 - a_2 b_1) c_3\\
                                            &= \det(\vec c, \vec a, \vec b)\\
                                            &= \det(\vec a, \vec b, \vec c)
    \end{align*}
    이다.
    마찬가지로 $\vec a \cdot (\vec b \times \vec c)$도 성분별로 계산을 해보면 $\det(\vec a, \vec b, \vec c)$임을 알 수 있다.
\end{proof}

\begin{theorem}
    $\vec a, \vec b, \vec c \in \mathbb R^3$가 이루는 평행체의 부피 $\Vol (\vec a, \vec b, \vec c)$는 $\lvert\det(\vec a, \vec b, \vec c)\rvert$이다.
\end{theorem}
\begin{proof}
    $\vec a$와 $\vec b$가 밑면을 이룬다고 하면, 그 면적은
    \begin{equation*}
        |\vec a \times \vec b|
    \end{equation*}
    이다.
    이 때 $\vec a \times \vec b$와 $\vec c$가 $\theta$의 각도를 이룬다고 하면, $\vec a, \vec b, \vec c$가 이루는 평행체의 부피는
    \begin{equation*}
        \Vol(\vec a, \vec b, \vec c) = |\vec a \times \vec b| \bigl| |\vec c| \cos \theta \bigr| = |(\vec a \times \vec b) \cdot \vec c|
    \end{equation*}
    이다.
    그런데 정리~\ref{thm:vec_prod_det}에 따라 $(\vec a \times \vec b) \cdot \vec c = \det (\vec a, \vec b, \vec c)$이므로,
    \begin{equation*}
        \Vol(\vec a, \vec b, \vec c) = \lvert\det(\vec a, \vec b, \vec c)\rvert
    \end{equation*}
    이 성립한다.
\end{proof}

\begin{definition}
    벡터 $\vec v_1, \dots, \vec v_n \in \mathbb R^n$이 양향(positively oriented)라는 것은
    \begin{equation*}
        \det(\vec v_1, \dots, \vec v_n) > 0
    \end{equation*}
    이라는 것이고, 음향(negatively oriented)이라는 것은
    \begin{equation*}
        \det(\vec v_1, \dots, \vec v_n) < 0
    \end{equation*}
    이라는 것이다.
    
    이 때 $\vec v_1, \dots, \vec v_n$에 의해 생성되는 평행체의 부호수를 가지는 부피(signed volume) $\sVol(\vec v_1, \dots, \vec v_n)$는
    \begin{equation*}
        \sVol(\vec v_1, \dots, \vec v_n) = \det(\vec v_1, \dots, \vec v_n)
    \end{equation*}
    으로 정의된다.
\end{definition}

\begin{remark}
    부호수를 가지는 부피 $\sVol$는 행렬식으로 정의되었으므로, 정리~\ref{thm:det_props}와 \ref{thm:ero_det}가 그대로 적용된다:
    \begin{enumerate}
        \item $\sVol(\vec a, k \vec b, \vec c) = k \sVol(\vec a, \vec b, \vec c)$
        \item $\sVol(\vec a, \vec b + \tilde{\vec b}, \vec c) = \sVol(\vec a, \vec b, \vec c) + \sVol(\vec a, \tilde{\vec b}, \vec c)$
        \item $\sVol(\vec a, \vec b, \vec c) = -\sVol(\vec b, \vec a, \vec c)$
    \end{enumerate}
\end{remark}

\begin{definition}
    $n \times n$ 행렬 $A$에 대해서 $i$행과 $j$열을 지운 행렬 $M_{ij}$를 소행렬식(minor)이라고 부르고, $C_{ij} = (-1)^{i + j} M_{ij}$를 여인수(cofactor)이라고 한다.
\end{definition}

\begin{theorem}
    $n \times n$ 행렬 $A = (a_{ij})$에 대해서, 라플라스 전개(Laplace expansion) 혹은 여인수 전개(cofactor expansion)는 다음과 같이 행렬식을 계산하는 것을 말한다:
    \begin{equation*}
        \det A = \sum_{k = 1}^n (-1)^{i + k} a_{ik} M_{ik} = \sum_{k = 1}^n a_{ik} C_{ik}
    \end{equation*}
\end{theorem}

\begin{example}
    다음은 $3 \time 3$ 행렬의 2행을 중심으로 여인수 전개를 한 것이다:
    \begin{equation*}
        \det
        \begin{pmatrix}
            a & b & c\\
            d & e & f\\
            g & h & i
        \end{pmatrix}
        = (-1)^{2 + 1} d \det
        \begin{pmatrix}
            b & c\\
            h & j
        \end{pmatrix}
        + (-1)^{2 + 2} e \det
        \begin{pmatrix}
            a & c\\
            g & j
        \end{pmatrix}
        + (-1)^{2 + 3} f \det
        \begin{pmatrix}
            a & b\\
            g & h
        \end{pmatrix}
    \end{equation*}
\end{example}

\begin{theorem}
    행렬 $A$가 가역행렬일 때, 다음과 같이 역행렬을 구할 수 있다:
    \begin{equation*}
        A^{-1} = \frac{1}{\det A} (C_{ij})^t
    \end{equation*}
    이 때 $(C_{ij})$는 여인수들의 행렬이다.
\end{theorem}
\end{document}
